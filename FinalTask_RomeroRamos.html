<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Pablo Romero &amp; Jorge Ramos">

<title>New VS Refurbished Apple Products: Data Harvesting Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="FinalTask_17Marzo2.0_files/libs/clipboard/clipboard.min.js"></script>
<script src="FinalTask_17Marzo2.0_files/libs/quarto-html/quarto.js"></script>
<script src="FinalTask_17Marzo2.0_files/libs/quarto-html/popper.min.js"></script>
<script src="FinalTask_17Marzo2.0_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="FinalTask_17Marzo2.0_files/libs/quarto-html/anchor.min.js"></script>
<link href="FinalTask_17Marzo2.0_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="FinalTask_17Marzo2.0_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="FinalTask_17Marzo2.0_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="FinalTask_17Marzo2.0_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="FinalTask_17Marzo2.0_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">New VS Refurbished Apple Products: Data Harvesting Final Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Pablo Romero &amp; Jorge Ramos </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="libraries-and-pre-configuration" class="level1">
<h1>Libraries and pre-configuration</h1>
<p>For the reproducibility of the project, the installation of the following packages is required. With this code, the reproducibility on other computers is guaranteed:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "scrapex"   "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[7] "methods"   "base"     

[[2]]
[1] "rvest"     "scrapex"   "stats"     "graphics"  "grDevices" "utils"    
[7] "datasets"  "methods"   "base"     

[[3]]
 [1] "httr"      "rvest"     "scrapex"   "stats"     "graphics"  "grDevices"
 [7] "utils"     "datasets"  "methods"   "base"     

[[4]]
 [1] "dplyr"     "httr"      "rvest"     "scrapex"   "stats"     "graphics" 
 [7] "grDevices" "utils"     "datasets"  "methods"   "base"     

[[5]]
 [1] "tidyr"     "dplyr"     "httr"      "rvest"     "scrapex"   "stats"    
 [7] "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     

[[6]]
 [1] "stringr"   "tidyr"     "dplyr"     "httr"      "rvest"     "scrapex"  
 [7] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[13] "base"     

[[7]]
 [1] "ggplot2"   "stringr"   "tidyr"     "dplyr"     "httr"      "rvest"    
 [7] "scrapex"   "stats"     "graphics"  "grDevices" "utils"     "datasets" 
[13] "methods"   "base"     

[[8]]
 [1] "RSelenium" "ggplot2"   "stringr"   "tidyr"     "dplyr"     "httr"     
 [7] "rvest"     "scrapex"   "stats"     "graphics"  "grDevices" "utils"    
[13] "datasets"  "methods"   "base"     

[[9]]
 [1] "xml2"      "RSelenium" "ggplot2"   "stringr"   "tidyr"     "dplyr"    
 [7] "httr"      "rvest"     "scrapex"   "stats"     "graphics"  "grDevices"
[13] "utils"     "datasets"  "methods"   "base"     

[[10]]
 [1] "magrittr"  "xml2"      "RSelenium" "ggplot2"   "stringr"   "tidyr"    
 [7] "dplyr"     "httr"      "rvest"     "scrapex"   "stats"     "graphics" 
[13] "grDevices" "utils"     "datasets"  "methods"   "base"     

[[11]]
 [1] "openxlsx"  "magrittr"  "xml2"      "RSelenium" "ggplot2"   "stringr"  
 [7] "tidyr"     "dplyr"     "httr"      "rvest"     "scrapex"   "stats"    
[13] "graphics"  "grDevices" "utils"     "datasets"  "methods"   "base"     

[[12]]
 [1] "shiny"     "openxlsx"  "magrittr"  "xml2"      "RSelenium" "ggplot2"  
 [7] "stringr"   "tidyr"     "dplyr"     "httr"      "rvest"     "scrapex"  
[13] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[19] "base"     </code></pre>
</div>
</div>
<p>Please change the user_agent as refered in the README Document:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_config</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">user_agent</span>(<span class="st">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36; Pablo Romero / rmepablo@gmail.com"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>The market for technology products is characterized by rapid innovation and renewal. One of the most relevant cases is that of the Apple brand, which introduces new flagship devices year after year, setting standards in design, performance and functionality. This pace of launches not only drives demand for the latest generation of products, but also gives rise to a parallel market for refurbished devices, an alternative that has been gaining relevance both for its lower cost and its impact on sustainability.</p>
<p>While purchasing refurbished products may represent an attractive option for consumers, questions arise as to how their prices vary compared to new devices. Are there patterns in the price reduction of older models when newer versions are released? Are discounts on refurbished products proportional to their age and specifications? What factors influence the availability of these products within Apple’s catalog?</p>
<p>This study seeks to answer these questions by collecting and analyzing data on new and refurbished Apple products. Through Web Scraping techniques with RSelenium, information will be extracted from official platforms and other relevant sources to build a dataset to evaluate the evolution of prices, availability and differences between both product categories.</p>
<p>In addition, an interactive application will be developed in Shiny, which will allow users to visualize price comparisons over time, identify trends in the commercialization of refurbished products and explore possible purchasing opportunities. In this way, the project will not only contribute to a better understanding of pricing dynamics in the Apple ecosystem, but will also provide a useful tool for consumers and analysts interested in this information.</p>
</section>
<section id="new-apple-products" class="level1">
<h1>New Apple Products</h1>
<p>Scraping the official Apple website is especially complicated, since the company’s security mechanisms make it difficult to extract data from it. So, one of the first decisions we made was to use the official website of one of its official distributors in Spain, instead of extracting the data from the company’s official website. Thus, the data scraping of new products will be done from the K-tuin page, where we have selected a model of each product (iPhone, iPad and Macbook).</p>
<p><img src="https://www.plazalogistica.com/wp-content/uploads/sites/5/2019/03/logoKtuin.jpg" class="img-fluid" width="285"></p>
<p>For all products, the process will be divided into the following steps:</p>
<ol type="1">
<li><p>Define the URL and read the page.</p></li>
<li><p>Extract the product information.</p></li>
<li><p>Extract the images.</p></li>
<li><p>Extract the names.</p></li>
<li><p>Extract the prices and their type.</p></li>
<li><p>Generate a dataframe and extract new variables from the product name.</p></li>
</ol>
<section id="iphone-16" class="level2">
<h2 class="anchored" data-anchor-id="iphone-16">iPhone 16</h2>
<section id="url" class="level4">
<h4 class="anchored" data-anchor-id="url">URL</h4>
<p>The first step is to obtain the information from the <strong>K-Tuin</strong> website where the iPhone 16s are listed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Tuin URL for the iPhone 16</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ktuin_link_iphone16 <span class="ot">&lt;-</span> <span class="st">"https://www.k-tuin.com/comprar-un-iphone/iphone-16"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the HTML of the page</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ktuin <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ktuin_link_iphone16)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With read_html(), we download the page content and save it in the variable ktuin to analyze its structure.</p>
</section>
<section id="product" class="level4">
<h4 class="anchored" data-anchor-id="product">Product</h4>
<p>Now we identify and extract all the products listed on the page, which are found in the ‘product-info’ class of the tags. Therefore, xml_find_all() is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer todos los productos (cada producto está en una 'div' con la clase 'product-info')</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> <span class="fu">xml_find_all</span>(ktuin, <span class="st">"//div[contains(@class, 'product-info')]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="images" class="level4">
<h4 class="anchored" data-anchor-id="images">Images</h4>
<p>In this step, we are going to find all the images and then filter them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the URLs of the images </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> <span class="fu">xml_attr</span>(<span class="fu">xml_find_all</span>(ktuin, <span class="st">"//img[@src]"</span>), <span class="st">"src"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> image_urls[<span class="fu">grepl</span>(<span class="st">"catalog"</span>, image_urls)]  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, the src attribute is extracted from all &lt;img&gt; tags that have the src attribute (the image URL) in the HTML content of the page. Then, the grepl filter is used to extract only the images that contain “catalog”.</p>
</section>
<section id="names" class="level4">
<h4 class="anchored" data-anchor-id="names">Names</h4>
<p>The names of the products are inside an &lt;h2&gt; tag within product-info.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the product's names</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_first</span>(<span class="st">".//h2[contains(@class, 'product-name')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prices" class="level4">
<h4 class="anchored" data-anchor-id="prices">Prices</h4>
<p>In this case, it should be noted that there are two prices: the Original Price, which is the price before the discount, and the Special Price, which is the discounted price. Both appear inside a &lt;p&gt; tag, in different classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract original prices</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>original_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'old-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the numeric values in even positions</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>original_prices <span class="ot">&lt;-</span> original_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(original_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract discounted prices </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>special_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'special-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the numeric values in even positions</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>special_prices <span class="ot">&lt;-</span> special_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(special_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-frame" class="level4">
<h4 class="anchored" data-anchor-id="data-frame">Data frame</h4>
<p>We store the information in a DataFrame and add additional columns for two variables that we will extract from the name later: storage and color.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame with the obtained data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>new_iphone <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> names,               <span class="co"># Use the product name as ID</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> names,             <span class="co"># Product name</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">original_price =</span> original_prices,  <span class="co"># Original price</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> special_prices,   <span class="co"># Discounted price</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">storage =</span> <span class="cn">NA</span>,             <span class="co"># Column for storage</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="cn">NA</span>,               <span class="co"># Column for color</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>, <span class="co"># Avoid factors to prevent issues with characters</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">image =</span> image_urls        <span class="co"># Image URL</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Storage and Color</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>new_iphone <span class="ot">&lt;-</span> new_iphone <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">storage =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+(GB|TB)"</span>),  <span class="co"># storage</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">str_remove</span>(name, <span class="st">"iPhone 16</span><span class="sc">\\</span><span class="st">s*</span><span class="sc">\\</span><span class="st">d*(GB|TB)?</span><span class="sc">\\</span><span class="st">s*"</span>) <span class="co"># Remove the storage from the name to leave only the color</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the names to only contain "iPhone 16"</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>new_iphone<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="st">"iPhone 16"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With these steps, we now have the table of the new iPhones with the data we wanted:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_iphone)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              id      name original_price      price storage
1          iPhone 16 128GB Negro iPhone 16       959,00&nbsp;€   799,00&nbsp;€   128GB
2         iPhone 16 128GB Blanco iPhone 16       959,00&nbsp;€   799,00&nbsp;€   128GB
3           iPhone 16 128GB Rosa iPhone 16       959,00&nbsp;€   799,00&nbsp;€   128GB
4  iPhone 16 128GB Azul ultramar iPhone 16       959,00&nbsp;€   799,00&nbsp;€   128GB
5  iPhone 16 128GB Verde azulado iPhone 16       959,00&nbsp;€   799,00&nbsp;€   128GB
6          iPhone 16 256GB Negro iPhone 16     1.089,00&nbsp;€   989,00&nbsp;€   256GB
7         iPhone 16 256GB Blanco iPhone 16     1.089,00&nbsp;€   989,00&nbsp;€   256GB
8           iPhone 16 256GB Rosa iPhone 16     1.089,00&nbsp;€   989,00&nbsp;€   256GB
9  iPhone 16 256GB Azul ultramar iPhone 16     1.089,00&nbsp;€   989,00&nbsp;€   256GB
10 iPhone 16 256GB Verde azulado iPhone 16     1.089,00&nbsp;€   989,00&nbsp;€   256GB
11         iPhone 16 512GB Negro iPhone 16     1.339,00&nbsp;€ 1.229,00&nbsp;€   512GB
12        iPhone 16 512GB Blanco iPhone 16     1.339,00&nbsp;€ 1.229,00&nbsp;€   512GB
13          iPhone 16 512GB Rosa iPhone 16     1.339,00&nbsp;€ 1.229,00&nbsp;€   512GB
14 iPhone 16 512GB Azul ultramar iPhone 16     1.339,00&nbsp;€ 1.229,00&nbsp;€   512GB
15 iPhone 16 512GB Verde azulado iPhone 16     1.339,00&nbsp;€ 1.229,00&nbsp;€   512GB
           color
1          Negro
2         Blanco
3           Rosa
4  Azul ultramar
5  Verde azulado
6          Negro
7         Blanco
8           Rosa
9  Azul ultramar
10 Verde azulado
11         Negro
12        Blanco
13          Rosa
14 Azul ultramar
15 Verde azulado
                                                                                                                                                       image
1       https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-negro-de-128-gb.jpg
2         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-blanco-128-gb.jpg
3           https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-rosa-128-gb.jpg
4  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-azul-ultramar-128-gb.jpg
5  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-verde-azulado-128-gb.jpg
6       https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-negro-de-256-gb.jpg
7         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-blanco-256-gb.jpg
8           https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-rosa-256-gb.jpg
9  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-azul-ultramar-256-gb.jpg
10 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-verde-azulado-256-gb.jpg
11      https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-negro-de-512-gb.jpg
12        https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-blanco-512-gb.jpg
13          https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-rosa-512-gb.jpg
14 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-azul-ultramar-512-gb.jpg
15 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/iphone-16-color-verde-azulado-512-gb.jpg</code></pre>
</div>
</div>
</section>
</section>
<section id="ipad-pro" class="level2">
<h2 class="anchored" data-anchor-id="ipad-pro">iPad Pro</h2>
<p>Now that we have completed the extraction and processing of data for the iPhone 16, let’s apply the same approach to an iPad Pro. By following similar steps, we will gather the necessary details.</p>
<section id="url-1" class="level4">
<h4 class="anchored" data-anchor-id="url-1">URL</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K-Tuin URL for the iPad Pro 13</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ktuin_link_ipadPRO <span class="ot">&lt;-</span> <span class="st">"https://www.k-tuin.com/comprar-un-ipad/nuevo-ipad-pro/nuevo-ipad-pro-13"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the HTML of the page</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>ktuin <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ktuin_link_ipadPRO)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="product-1" class="level4">
<h4 class="anchored" data-anchor-id="product-1">Product</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract all products (div with the 'product-element' class)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> <span class="fu">xml_find_all</span>(ktuin, <span class="st">"//div[contains(@class, 'product-element')]"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{xml_nodeset (24)}
 [1] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https: ...
 [2] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https: ...
 [3] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https: ...
 [4] &lt;div class="product-element first-row last"&gt;\n                &lt;a href="h ...
 [5] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
 [6] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
 [7] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
 [8] &lt;div class="product-element last"&gt;\n                &lt;a href="https://www ...
 [9] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[10] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[11] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[12] &lt;div class="product-element last"&gt;\n                &lt;a href="https://www ...
[13] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[14] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[15] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[16] &lt;div class="product-element last"&gt;\n                &lt;a href="https://www ...
[17] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[18] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[19] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tu ...
[20] &lt;div class="product-element last"&gt;\n                &lt;a href="https://www ...
...</code></pre>
</div>
</div>
</section>
<section id="images-1" class="level4">
<h4 class="anchored" data-anchor-id="images-1">Images</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract image URLs (src attribute)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> <span class="fu">xml_attr</span>(<span class="fu">xml_find_all</span>(ktuin, <span class="st">"//img[@src]"</span>), <span class="st">"src"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only the relevant images (those containing 'catalog')</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> image_urls[<span class="fu">grepl</span>(<span class="st">"catalog"</span>, image_urls)]</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(image_urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
 [2] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
 [3] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
 [4] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
 [5] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
 [6] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
 [7] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
 [8] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
 [9] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
[10] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
[11] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg"
[12] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg"        
[13] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-wifi-space-negro.jpg"          
[14] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    
[15] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro.jpg"             
[16] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    
[17] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro_1.jpg"           
[18] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    
[19] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro_2.jpg"           
[20] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    
[21] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-cellular-space-black-1.jpg"    
[22] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    
[23] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-cellular-space-black-1_1.jpg"  
[24] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg"    </code></pre>
</div>
</div>
</section>
<section id="names-1" class="level4">
<h4 class="anchored" data-anchor-id="names-1">Names</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract product names</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_first</span>(<span class="st">".//h2[contains(@class, 'product-name')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">|Nuevo|</span><span class="sc">\\</span><span class="st">s{2,}"</span>, <span class="st">""</span>, .)  <span class="co"># Remove line breaks, "Nuevo", and extra spaces</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "iPad Pro 13\" Chip M4 256GB Negro espacial"                              
 [2] "iPad Pro 13\" Chip M4 256GB Plata"                                       
 [3] "iPad Pro 13\" Chip M4 512GB Negro espacial"                              
 [4] "iPad Pro 13\" Chip M4 512GB Plata"                                       
 [5] "iPad Pro 13\" Chip M4 1TB Negro espacial"                                
 [6] "iPad Pro 13\" Chip M4 1TB Plata"                                         
 [7] "iPad Pro 13\" Chip M4 1TB Vidrio Nanotexturizado Negro espacial"         
 [8] "iPad Pro 13\" Chip M4 1TB Vidrio Nanotexturizado Plata"                  
 [9] "iPad Pro 13\" Chip M4 2TB Negro espacial"                                
[10] "iPad Pro 13\" Chip M4 2TB Plata"                                         
[11] "iPad Pro 13\" Chip M4 2TB Vidrio Nanotexturizado Negro espacial"         
[12] "iPad Pro 13\" Chip M4 2TB Vidrio Nanotexturizado Plata"                  
[13] "iPad Pro 13\" Chip M4 256GB Cellular Negro espacial"                     
[14] "iPad Pro 13\" Chip M4 256GB Cellular Plata"                              
[15] "iPad Pro 13\" Chip M4 512GB Cellular Negro espacial"                     
[16] "iPad Pro 13\" Chip M4 512GB Cellular Plata"                              
[17] "iPad Pro 13\" Chip M4 1TB Cellular Negro espacial"                       
[18] "iPad Pro 13\" Chip M4 1TB Cellular Plata"                                
[19] "iPad Pro 13\" Chip M4 1TB Cellular Vidrio Nanotexturizado Negro espacial"
[20] "iPad Pro 13\" Chip M4 1TB Cellular Vidrio Nanotexturizado Plata"         
[21] "iPad Pro 13\" Chip M4 2TB Cellular Negro espacial"                       
[22] "iPad Pro 13\" Chip M4 2TB Cellular Plata"                                
[23] "iPad Pro 13\" Chip M4 2TB Cellular Vidrio Nanotexturizado Negro espacial"
[24] "iPad Pro 13\" Chip M4 2TB Cellular Vidrio Nanotexturizado Plata"         </code></pre>
</div>
</div>
</section>
<section id="prices-1" class="level4">
<h4 class="anchored" data-anchor-id="prices-1">Prices</h4>
<p>In this case, there are three types of prices because some products do not have a discount. Therefore, there will be Old Price, Special Price, and Regular Price.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract original prices</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>original_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'old-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only numeric values from even positions</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>original_prices <span class="ot">&lt;-</span> original_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(original_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(original_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1.549,00&nbsp;€" "1.549,00&nbsp;€" "1.799,00&nbsp;€" "1.799,00&nbsp;€" "2.279,00&nbsp;€"
 [6] "2.279,00&nbsp;€" "2.409,00&nbsp;€" "2.409,00&nbsp;€" "2.759,00&nbsp;€" "2.759,00&nbsp;€"
[11] "2.889,00&nbsp;€" "2.889,00&nbsp;€" "1.799,00&nbsp;€" "1.799,00&nbsp;€" "2.049,00&nbsp;€"
[16] "2.049,00&nbsp;€" "2.529,00&nbsp;€" "2.529,00&nbsp;€" "2.659,00&nbsp;€" "2.659,00&nbsp;€"
[21] "3.009,00&nbsp;€" "3.009,00&nbsp;€" "3.139,00&nbsp;€" "3.139,00&nbsp;€"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract special prices</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>special_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'special-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only numeric values from even positions</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>special_prices <span class="ot">&lt;-</span> special_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(special_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(special_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1.469,00&nbsp;€" "1.469,00&nbsp;€" "1.699,00&nbsp;€" "1.699,00&nbsp;€" "2.159,00&nbsp;€"
 [6] "2.159,00&nbsp;€" "2.289,00&nbsp;€" "2.289,00&nbsp;€" "2.619,00&nbsp;€" "2.619,00&nbsp;€"
[11] "2.739,00&nbsp;€" "2.739,00&nbsp;€" "1.699,00&nbsp;€" "1.699,00&nbsp;€" "1.939,00&nbsp;€"
[16] "1.939,00&nbsp;€" "2.399,00&nbsp;€" "2.399,00&nbsp;€" "2.529,00&nbsp;€" "2.529,00&nbsp;€"
[21] "2.859,00&nbsp;€" "2.859,00&nbsp;€" "2.979,00&nbsp;€" "2.999,00&nbsp;€"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract regular prices</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>regular_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//span[contains(@class, 'regular-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># No filtering needed as there are no duplicates</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>regular_prices <span class="ot">&lt;-</span> regular_prices_raw</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(regular_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
</section>
<section id="data-frame-1" class="level4">
<h4 class="anchored" data-anchor-id="data-frame-1">Data Frame</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DataFrame</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>new_ipad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> names,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> names,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">original_price =</span> <span class="cn">NA</span>,  <span class="co"># Original price</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="cn">NA</span>,           <span class="co"># Final price</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">storage =</span> <span class="cn">NA</span>,         <span class="co"># Storage capacity</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="cn">NA</span>,           <span class="co"># iPad color</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">image =</span> image_urls    <span class="co"># Image URL</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign original prices if they exist</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>new_ipad<span class="sc">$</span>original_price[<span class="sc">!</span><span class="fu">is.na</span>(original_prices)] <span class="ot">&lt;-</span> original_prices</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign special prices if they exist</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>new_ipad<span class="sc">$</span>price[<span class="sc">!</span><span class="fu">is.na</span>(special_prices)] <span class="ot">&lt;-</span> special_prices</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># If there is no special price, use the regular price</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>new_ipad<span class="sc">$</span>price[<span class="fu">is.na</span>(new_ipad<span class="sc">$</span>price)] <span class="ot">&lt;-</span> regular_prices</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># If there is no original price, assign the same as the final price</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>new_ipad<span class="sc">$</span>original_price[<span class="fu">is.na</span>(new_ipad<span class="sc">$</span>original_price)] <span class="ot">&lt;-</span> new_ipad<span class="sc">$</span>price[<span class="fu">is.na</span>(new_ipad<span class="sc">$</span>original_price)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Additionally, in this case, we have special features for this product that were not present in the iPhones, as there are two types of iPad models depending on connectivity: “Wi-Fi” and “Cellular”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>new_ipad <span class="ot">&lt;-</span> new_ipad <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Storage: Extract storage </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">storage =</span> <span class="fu">str_extract</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+(GB|TB)"</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Color: Extract the color without the "Cellular" part</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">str_remove</span>(name, <span class="st">".*</span><span class="sc">\\</span><span class="st">d+(GB|TB)</span><span class="sc">\\</span><span class="st">s"</span>),  <span class="co"># Extract everything after storage</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">str_remove</span>(color, <span class="st">"Cellular"</span>),  <span class="co"># Remove the word "Cellular" if it exists</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">str_trim</span>(color),  <span class="co"># Clean up extra spaces</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust Name: If the name contains "Cellular", add it correctly</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Cellular"</span>, name), </span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">gsub</span>(<span class="st">"iPad Pro 13</span><span class="sc">\"</span><span class="st"> Chip M4.*"</span>, <span class="st">"iPad Pro 13</span><span class="sc">\"</span><span class="st"> Chip M4 + Cellular"</span>, name),</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">gsub</span>(<span class="st">"iPad Pro 13</span><span class="sc">\"</span><span class="st"> Chip M4.*"</span>, <span class="st">"iPad Pro 13</span><span class="sc">\"</span><span class="st"> Chip M4"</span>, name)),</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Connectivity: Assign "Cellular" or "Wi-Fi"</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">connectivity =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"Cellular"</span>, id), <span class="st">"Cellular"</span>, <span class="st">"Wi-Fi"</span>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we have all the data saved in the table of iPad:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_ipad)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                        id
1                                iPad Pro 13" Chip M4 256GB Negro espacial
2                                         iPad Pro 13" Chip M4 256GB Plata
3                                iPad Pro 13" Chip M4 512GB Negro espacial
4                                         iPad Pro 13" Chip M4 512GB Plata
5                                  iPad Pro 13" Chip M4 1TB Negro espacial
6                                           iPad Pro 13" Chip M4 1TB Plata
7           iPad Pro 13" Chip M4 1TB Vidrio Nanotexturizado Negro espacial
8                    iPad Pro 13" Chip M4 1TB Vidrio Nanotexturizado Plata
9                                  iPad Pro 13" Chip M4 2TB Negro espacial
10                                          iPad Pro 13" Chip M4 2TB Plata
11          iPad Pro 13" Chip M4 2TB Vidrio Nanotexturizado Negro espacial
12                   iPad Pro 13" Chip M4 2TB Vidrio Nanotexturizado Plata
13                      iPad Pro 13" Chip M4 256GB Cellular Negro espacial
14                               iPad Pro 13" Chip M4 256GB Cellular Plata
15                      iPad Pro 13" Chip M4 512GB Cellular Negro espacial
16                               iPad Pro 13" Chip M4 512GB Cellular Plata
17                        iPad Pro 13" Chip M4 1TB Cellular Negro espacial
18                                 iPad Pro 13" Chip M4 1TB Cellular Plata
19 iPad Pro 13" Chip M4 1TB Cellular Vidrio Nanotexturizado Negro espacial
20          iPad Pro 13" Chip M4 1TB Cellular Vidrio Nanotexturizado Plata
21                        iPad Pro 13" Chip M4 2TB Cellular Negro espacial
22                                 iPad Pro 13" Chip M4 2TB Cellular Plata
23 iPad Pro 13" Chip M4 2TB Cellular Vidrio Nanotexturizado Negro espacial
24          iPad Pro 13" Chip M4 2TB Cellular Vidrio Nanotexturizado Plata
                              name original_price      price storage
1             iPad Pro 13" Chip M4     1.549,00&nbsp;€ 1.469,00&nbsp;€   256GB
2             iPad Pro 13" Chip M4     1.549,00&nbsp;€ 1.469,00&nbsp;€   256GB
3             iPad Pro 13" Chip M4     1.799,00&nbsp;€ 1.699,00&nbsp;€   512GB
4             iPad Pro 13" Chip M4     1.799,00&nbsp;€ 1.699,00&nbsp;€   512GB
5             iPad Pro 13" Chip M4     2.279,00&nbsp;€ 2.159,00&nbsp;€     1TB
6             iPad Pro 13" Chip M4     2.279,00&nbsp;€ 2.159,00&nbsp;€     1TB
7             iPad Pro 13" Chip M4     2.409,00&nbsp;€ 2.289,00&nbsp;€     1TB
8             iPad Pro 13" Chip M4     2.409,00&nbsp;€ 2.289,00&nbsp;€     1TB
9             iPad Pro 13" Chip M4     2.759,00&nbsp;€ 2.619,00&nbsp;€     2TB
10            iPad Pro 13" Chip M4     2.759,00&nbsp;€ 2.619,00&nbsp;€     2TB
11            iPad Pro 13" Chip M4     2.889,00&nbsp;€ 2.739,00&nbsp;€     2TB
12            iPad Pro 13" Chip M4     2.889,00&nbsp;€ 2.739,00&nbsp;€     2TB
13 iPad Pro 13" Chip M4 + Cellular     1.799,00&nbsp;€ 1.699,00&nbsp;€   256GB
14 iPad Pro 13" Chip M4 + Cellular     1.799,00&nbsp;€ 1.699,00&nbsp;€   256GB
15 iPad Pro 13" Chip M4 + Cellular     2.049,00&nbsp;€ 1.939,00&nbsp;€   512GB
16 iPad Pro 13" Chip M4 + Cellular     2.049,00&nbsp;€ 1.939,00&nbsp;€   512GB
17 iPad Pro 13" Chip M4 + Cellular     2.529,00&nbsp;€ 2.399,00&nbsp;€     1TB
18 iPad Pro 13" Chip M4 + Cellular     2.529,00&nbsp;€ 2.399,00&nbsp;€     1TB
19 iPad Pro 13" Chip M4 + Cellular     2.659,00&nbsp;€ 2.529,00&nbsp;€     1TB
20 iPad Pro 13" Chip M4 + Cellular     2.659,00&nbsp;€ 2.529,00&nbsp;€     1TB
21 iPad Pro 13" Chip M4 + Cellular     3.009,00&nbsp;€ 2.859,00&nbsp;€     2TB
22 iPad Pro 13" Chip M4 + Cellular     3.009,00&nbsp;€ 2.859,00&nbsp;€     2TB
23 iPad Pro 13" Chip M4 + Cellular     3.139,00&nbsp;€ 2.979,00&nbsp;€     2TB
24 iPad Pro 13" Chip M4 + Cellular     3.139,00&nbsp;€ 2.999,00&nbsp;€     2TB
                                   color
1                         Negro espacial
2                                  Plata
3                         Negro espacial
4                                  Plata
5                         Negro espacial
6                                  Plata
7  Vidrio Nanotexturizado Negro espacial
8           Vidrio Nanotexturizado Plata
9                         Negro espacial
10                                 Plata
11 Vidrio Nanotexturizado Negro espacial
12          Vidrio Nanotexturizado Plata
13                        Negro espacial
14                                 Plata
15                        Negro espacial
16                                 Plata
17                        Negro espacial
18                                 Plata
19 Vidrio Nanotexturizado Negro espacial
20          Vidrio Nanotexturizado Plata
21                        Negro espacial
22                                 Plata
23 Vidrio Nanotexturizado Negro espacial
24          Vidrio Nanotexturizado Plata
                                                                                                                                                         image
1  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
2          https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
3  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
4          https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
5  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
6          https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
7  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
8          https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
9  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
10         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
11 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
12         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
13           https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-wifi-space-negro.jpg
14     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
15              https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro.jpg
16     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
17            https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro_1.jpg
18     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
19            https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-m4-wifi-negro_2.jpg
20     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
21     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-cellular-space-black-1.jpg
22     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
23   https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-cellular-space-black-1_1.jpg
24     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-cellular-plata.jpg
   connectivity
1         Wi-Fi
2         Wi-Fi
3         Wi-Fi
4         Wi-Fi
5         Wi-Fi
6         Wi-Fi
7         Wi-Fi
8         Wi-Fi
9         Wi-Fi
10        Wi-Fi
11        Wi-Fi
12        Wi-Fi
13     Cellular
14     Cellular
15     Cellular
16     Cellular
17     Cellular
18     Cellular
19     Cellular
20     Cellular
21     Cellular
22     Cellular
23     Cellular
24     Cellular</code></pre>
</div>
</div>
</section>
</section>
<section id="macbook-air" class="level2">
<h2 class="anchored" data-anchor-id="macbook-air">Macbook Air</h2>
<p>Finally, we will perform the same steps with a MacBook Air. In this case, the process is similar to what we followed for the iPhones and iPads, but with some specific differences for this model, such as the prices, features, and specifications.</p>
<section id="url-2" class="level4">
<h4 class="anchored" data-anchor-id="url-2">URL</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># URL for K-Tuin's MacBook Air M2</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ktuin_link_airm2 <span class="ot">&lt;-</span> <span class="st">"https://www.k-tuin.com/comprar-un-mac/nuevo-macbook-air"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the HTML content of the page</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ktuin <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ktuin_link_airm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="product-2" class="level4">
<h4 class="anchored" data-anchor-id="product-2">Product</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract all the products (div with the 'product-element' class)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>products <span class="ot">&lt;-</span> <span class="fu">xml_find_all</span>(ktuin, <span class="st">"//div[contains(@class, 'product-element')]"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{xml_nodeset (8)}
[1] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https:/ ...
[2] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https:/ ...
[3] &lt;div class="product-element first-row"&gt;\n                &lt;a href="https:/ ...
[4] &lt;div class="product-element first-row last"&gt;\n                &lt;a href="ht ...
[5] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tui ...
[6] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tui ...
[7] &lt;div class="product-element"&gt;\n                &lt;a href="https://www.k-tui ...
[8] &lt;div class="product-element last"&gt;\n                &lt;a href="https://www. ...</code></pre>
</div>
</div>
</section>
<section id="images-2" class="level4">
<h4 class="anchored" data-anchor-id="images-2">Images</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract image URLs (attribute 'src')</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> <span class="fu">xml_attr</span>(<span class="fu">xml_find_all</span>(ktuin, <span class="st">"//img[@src]"</span>), <span class="st">"src"</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter only relevant images (those that contain 'catalog' in the URL)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>image_urls <span class="ot">&lt;-</span> image_urls[<span class="fu">grepl</span>(<span class="st">"catalog"</span>, image_urls)]</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(image_urls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-16gb.jpg"                 
[2] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-medianoche-16gb_7.jpg"    
[3] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-plata-16gb.jpg"           
[4] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-blanco-estrella-16gb.jpg" 
[5] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-512gb.jpg"                
[6] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-medianoche-512gb.jpg"     
[7] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-plata-512gb.jpg"          
[8] "https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-blanco-estrella-512gb.jpg"</code></pre>
</div>
</div>
</section>
<section id="names-2" class="level4">
<h4 class="anchored" data-anchor-id="names-2">Names</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer nombres de los productos</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_first</span>(<span class="st">".//h2[contains(@class, 'product-name')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">|Nuevo|</span><span class="sc">\\</span><span class="st">s{2,}"</span>, <span class="st">""</span>, .)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar los nombres extraídos</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MacBook Air 13\" Chip M2 16GB 256GB Gris espacial"  
[2] "MacBook Air 13\" Chip M2 16GB 256GB Medianoche"     
[3] "MacBook Air 13\" Chip M2 16GB 256GB Plata"          
[4] "MacBook Air 13\" Chip M2 16GB 256GB Blanco estrella"
[5] "MacBook Air 13\" Chip M2 8GB 512GB Gris Espacial"   
[6] "MacBook Air 13\" Chip M2 8GB 512GB Medianoche"      
[7] "MacBook Air 13\" Chip M2 8GB 512GB Plata"           
[8] "MacBook Air 13\" Chip M2 8GB 512GB Blanco Estrella" </code></pre>
</div>
</div>
</section>
<section id="prices-2" class="level4">
<h4 class="anchored" data-anchor-id="prices-2">Prices</h4>
<p>In this case, there are only two types of prices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract original prices</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>original_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'old-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the numeric values at even positions</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>original_prices <span class="ot">&lt;-</span> original_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(original_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(original_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1.199,00&nbsp;€" "1.199,00&nbsp;€" "1.199,00&nbsp;€" "1.199,00&nbsp;€" "1.319,00&nbsp;€"
[6] "1.319,00&nbsp;€" "1.319,00&nbsp;€" "1.319,00&nbsp;€"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract special prices </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>special_prices_raw <span class="ot">&lt;-</span> products <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_find_all</span>(<span class="st">".//p[contains(@class, 'special-price')]/span[contains(@class, 'price')]"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xml_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract only the numeric values at even positions</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>special_prices <span class="ot">&lt;-</span> special_prices_raw[<span class="fu">seq</span>(<span class="dv">2</span>, <span class="fu">length</span>(special_prices_raw), <span class="at">by =</span> <span class="dv">2</span>)]</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(special_prices)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "869,00&nbsp;€" "999,00&nbsp;€" "869,00&nbsp;€" "999,00&nbsp;€" "899,00&nbsp;€" "899,00&nbsp;€" "899,00&nbsp;€"
[8] "899,00&nbsp;€"</code></pre>
</div>
</div>
</section>
<section id="data-frame-2" class="level4">
<h4 class="anchored" data-anchor-id="data-frame-2">Data Frame</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>discount_products <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)  </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the DataFrame with default NA values</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>new_macbook <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> names,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> names,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">original_price =</span> <span class="cn">NA</span>,  <span class="co"># Original price (crossed out)</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">price =</span> <span class="cn">NA</span>,           <span class="co"># Final price</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">image =</span> image_urls    <span class="co"># Image URL</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign original prices to the discounted products</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>new_macbook<span class="sc">$</span>original_price[discount_products] <span class="ot">&lt;-</span> original_prices</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign special prices to the discounted products</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>new_macbook<span class="sc">$</span>price[discount_products] <span class="ot">&lt;-</span> special_prices  </span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># If there is no original price, assign the same value as the final price</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>new_macbook<span class="sc">$</span>original_price[<span class="fu">is.na</span>(new_macbook<span class="sc">$</span>original_price)] <span class="ot">&lt;-</span> new_macbook<span class="sc">$</span>price[<span class="fu">is.na</span>(new_macbook<span class="sc">$</span>original_price)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this case, there is also another feature that is not present in the iPhone or iPad, which is the RAM:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>new_macbook <span class="ot">&lt;-</span> new_macbook <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract RAM </span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ram =</span> <span class="fu">str_match</span>(name, <span class="st">"(</span><span class="sc">\\</span><span class="st">d+GB)"</span>)[,<span class="dv">2</span>],  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract storage </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">storage =</span> <span class="fu">str_match</span>(name, <span class="st">"</span><span class="sc">\\</span><span class="st">d+GB (</span><span class="sc">\\</span><span class="st">d+GB)"</span>)[,<span class="dv">2</span>],  </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract color </span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">str_remove</span>(name, <span class="st">".*</span><span class="sc">\\</span><span class="st">d+GB </span><span class="sc">\\</span><span class="st">d+GB "</span>),  </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Adjust product name </span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">str_remove</span>(name, <span class="st">" </span><span class="sc">\\</span><span class="st">d+GB </span><span class="sc">\\</span><span class="st">d+GB .*"</span>)  </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can check the MacBook table, and thus finish the dataframes of the new products, which we will combine later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(new_macbook)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                  id                    name
1   MacBook Air 13" Chip M2 16GB 256GB Gris espacial MacBook Air 13" Chip M2
2      MacBook Air 13" Chip M2 16GB 256GB Medianoche MacBook Air 13" Chip M2
3           MacBook Air 13" Chip M2 16GB 256GB Plata MacBook Air 13" Chip M2
4 MacBook Air 13" Chip M2 16GB 256GB Blanco estrella MacBook Air 13" Chip M2
5    MacBook Air 13" Chip M2 8GB 512GB Gris Espacial MacBook Air 13" Chip M2
6       MacBook Air 13" Chip M2 8GB 512GB Medianoche MacBook Air 13" Chip M2
7            MacBook Air 13" Chip M2 8GB 512GB Plata MacBook Air 13" Chip M2
8  MacBook Air 13" Chip M2 8GB 512GB Blanco Estrella MacBook Air 13" Chip M2
  original_price    price
1     1.199,00&nbsp;€ 869,00&nbsp;€
2     1.199,00&nbsp;€ 999,00&nbsp;€
3     1.199,00&nbsp;€ 869,00&nbsp;€
4     1.199,00&nbsp;€ 999,00&nbsp;€
5     1.319,00&nbsp;€ 899,00&nbsp;€
6     1.319,00&nbsp;€ 899,00&nbsp;€
7     1.319,00&nbsp;€ 899,00&nbsp;€
8     1.319,00&nbsp;€ 899,00&nbsp;€
                                                                                                                                                               image
1                  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-16gb.jpg
2     https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-medianoche-16gb_7.jpg
3            https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-plata-16gb.jpg
4  https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-blanco-estrella-16gb.jpg
5                 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-512gb.jpg
6      https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-medianoche-512gb.jpg
7           https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-plata-512gb.jpg
8 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/m/a/macbook-air-m2-de-apple-blanco-estrella-512gb.jpg
   ram storage           color
1 16GB   256GB   Gris espacial
2 16GB   256GB      Medianoche
3 16GB   256GB           Plata
4 16GB   256GB Blanco estrella
5  8GB   512GB   Gris Espacial
6  8GB   512GB      Medianoche
7  8GB   512GB           Plata
8  8GB   512GB Blanco Estrella</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="refurbished-apple-products" class="level1">
<h1>Refurbished Apple Products</h1>
<p>For the refurbished products, the Spanish company iServices was chosen, as it is one of the most relevant companies dedicated to the repair and refurbishment of electronic devices. In the same way, it was decided to select three products (iPhone, iPad and MacBook). Thus, for this second section, we will use Selenium to ensure the coverage of scraping techniques given throughout the Data Harvesting course. Before starting this second section, please refer to the README document with information regarding the download of Selenium, Java and Mozilla Firefox for proper operation.</p>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTS6rUgSGsD4l7i2sRU5ghFmJoi1hTOme82AA9gdt2689cqPuVo1w2HfKlcNDBYCWNu-b0&amp;usqp=CAU.png" class="img-fluid"></p>
<p>The first step is to start the Selenium client, which is accomplished with the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>rD <span class="ot">&lt;-</span> <span class="fu">rsDriver</span>(<span class="at">browser =</span> <span class="st">"firefox"</span>, <span class="at">geckover =</span> <span class="st">"latest"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>checking Selenium Server versions:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: PREDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: DOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: POSTDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>checking chromedriver versions:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: PREDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: DOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: POSTDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>checking geckodriver versions:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: PREDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: DOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: POSTDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>checking phantomjs versions:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: PREDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: DOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>BEGIN: POSTDOWNLOAD</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Connecting to remote server"
$acceptInsecureCerts
[1] FALSE

$browserName
[1] "firefox"

$browserVersion
[1] "136.0.2"

$`moz:accessibilityChecks`
[1] FALSE

$`moz:buildID`
[1] "20250317120031"

$`moz:geckodriverVersion`
[1] "0.36.0"

$`moz:headless`
[1] FALSE

$`moz:platformVersion`
[1] "24.0.0"

$`moz:processID`
[1] 77488

$`moz:profile`
[1] "/var/folders/5r/m647c8gx129c8zd0qtxv46cc0000gn/T/rust_mozprofileM4DkAL"

$`moz:shutdownTimeout`
[1] 60000

$`moz:webdriverClick`
[1] TRUE

$`moz:windowless`
[1] FALSE

$pageLoadStrategy
[1] "normal"

$platformName
[1] "mac"

$proxy
named list()

$setWindowRect
[1] TRUE

$strictFileInteractability
[1] FALSE

$timeouts
$timeouts$implicit
[1] 0

$timeouts$pageLoad
[1] 300000

$timeouts$script
[1] 30000


$unhandledPromptBehavior
[1] "dismiss and notify"

$userAgent
[1] "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:136.0) Gecko/20100101 Firefox/136.0"

$webdriver.remote.sessionid
[1] "1fc5ea8e-4085-4b5b-b09c-c889a65e5bd7"

$id
[1] "1fc5ea8e-4085-4b5b-b09c-c889a65e5bd7"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>remDr <span class="ot">&lt;-</span> rD<span class="sc">$</span>client</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once started, we start the whole scrapping process, which is done in its entirety once you decide to run the next chunk. The fact that all the scraping part is done at the same time is to show the power of the tool, which allows you to browse several pages within a website without having to do anything.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>remDr <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">10</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">navigate</span>(<span class="st">"https://canarias.iservices.es/"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>}) ()</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>remDr <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//button[contains(@class, 'cm-btn-danger')]"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    input_box <span class="ot">&lt;-</span> x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//input[@id='inputSearch']"</span>)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    input_box<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="st">"iphone 16"</span>))</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//button[@class='form-search']//img"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  })()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$remoteServerAddr
[1] "localhost"

$port
[1] 4567

$browserName
[1] "firefox"

$version
[1] ""

$platform
[1] "ANY"

$javascript
[1] TRUE

$nativeEvents
[1] TRUE

$extraCapabilities
list()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>remDr <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//div[@class='search-result-box transform-ts h-scale-sm']//a[contains(@class, 'btn-warning')]"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//button[contains(@class, 'cm-btn-info')]"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//button[contains(@class, 'cm-btn-success') and contains(@class, 'cm-btn-info')]"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  })()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$remoteServerAddr
[1] "localhost"

$port
[1] 4567

$browserName
[1] "firefox"

$version
[1] ""

$platform
[1] "ANY"

$javascript
[1] TRUE

$nativeEvents
[1] TRUE

$extraCapabilities
list()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#iPhone 16</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>price_selector <span class="ot">&lt;-</span> <span class="st">"div.current-price span"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>product_name_selector <span class="ot">&lt;-</span> <span class="st">"h1.h1.page-title"</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>color_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_81 li.float-xs-left.input-container label.simptip-position-top"</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>state_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_10 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>capacity_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_14 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>extract_price <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr) {</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  price_element <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> price_selector)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  price_text <span class="ot">&lt;-</span> price_element<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  clean_price <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^0-9,.]"</span>, <span class="st">""</span>, price_text)</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, clean_price)))</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>get_colors <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr) {</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>  elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> color_selectors)</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (el <span class="cf">in</span> elements) {</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>      name <span class="ot">&lt;-</span> el<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> <span class="st">"span.color"</span>)<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>      input <span class="ot">&lt;-</span> el<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> <span class="st">"input.input-color"</span>)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>      colors[[<span class="fu">length</span>(colors) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> name, <span class="at">element =</span> input)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {})</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(colors)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>get_options <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr, selector) {</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) </span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>  elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> selector)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a>  options <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (el <span class="cf">in</span> elements) {</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>      name <span class="ot">&lt;-</span> el<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"value"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>      options[[<span class="fu">length</span>(options) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> name, <span class="at">element =</span> el)</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {})</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(options)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>product_name <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> product_name_selector)<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>color_info <span class="ot">&lt;-</span> <span class="fu">get_colors</span>(remDr)</span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(color_info)) {</span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) </span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>  color_info <span class="ot">&lt;-</span> <span class="fu">get_colors</span>(remDr) </span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(color_info) <span class="sc">&lt;</span> i) <span class="cf">next</span> </span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>  color_info[[i]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>) </span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>  current_color <span class="ot">&lt;-</span> color_info[[i]]<span class="sc">$</span>name</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Selected color:"</span>, current_color))</span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>  state_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, state_selectors)</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(state_info)) {</span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>) </span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>    state_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, state_selectors) </span>
<span id="cb68-66"><a href="#cb68-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(state_info) <span class="sc">&lt;</span> j) <span class="cf">next</span></span>
<span id="cb68-67"><a href="#cb68-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-68"><a href="#cb68-68" aria-hidden="true" tabindex="-1"></a>    state_info[[j]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb68-69"><a href="#cb68-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb68-70"><a href="#cb68-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-71"><a href="#cb68-71" aria-hidden="true" tabindex="-1"></a>    current_state <span class="ot">&lt;-</span> state_info[[j]]<span class="sc">$</span>name</span>
<span id="cb68-72"><a href="#cb68-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-73"><a href="#cb68-73" aria-hidden="true" tabindex="-1"></a>    capacity_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, capacity_selectors)</span>
<span id="cb68-74"><a href="#cb68-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-75"><a href="#cb68-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_along</span>(capacity_info)) {</span>
<span id="cb68-76"><a href="#cb68-76" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb68-77"><a href="#cb68-77" aria-hidden="true" tabindex="-1"></a>      capacity_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, capacity_selectors)</span>
<span id="cb68-78"><a href="#cb68-78" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">length</span>(capacity_info) <span class="sc">&lt;</span> k) <span class="cf">next</span></span>
<span id="cb68-79"><a href="#cb68-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-80"><a href="#cb68-80" aria-hidden="true" tabindex="-1"></a>      capacity_info[[k]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb68-81"><a href="#cb68-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb68-82"><a href="#cb68-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-83"><a href="#cb68-83" aria-hidden="true" tabindex="-1"></a>      current_capacity <span class="ot">&lt;-</span> capacity_info[[k]]<span class="sc">$</span>name</span>
<span id="cb68-84"><a href="#cb68-84" aria-hidden="true" tabindex="-1"></a>      price <span class="ot">&lt;-</span> <span class="fu">extract_price</span>(remDr)</span>
<span id="cb68-85"><a href="#cb68-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-86"><a href="#cb68-86" aria-hidden="true" tabindex="-1"></a>      results[[<span class="fu">length</span>(results) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-87"><a href="#cb68-87" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> product_name,</span>
<span id="cb68-88"><a href="#cb68-88" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> current_color,</span>
<span id="cb68-89"><a href="#cb68-89" aria-hidden="true" tabindex="-1"></a>        <span class="at">state =</span> current_state,</span>
<span id="cb68-90"><a href="#cb68-90" aria-hidden="true" tabindex="-1"></a>        <span class="at">storage =</span> current_capacity,</span>
<span id="cb68-91"><a href="#cb68-91" aria-hidden="true" tabindex="-1"></a>        <span class="at">price =</span> price,</span>
<span id="cb68-92"><a href="#cb68-92" aria-hidden="true" tabindex="-1"></a>        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb68-93"><a href="#cb68-93" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb68-94"><a href="#cb68-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-95"><a href="#cb68-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processed:"</span>, current_color, <span class="st">"-"</span>, current_state, <span class="st">"-"</span>, current_capacity, <span class="st">"- Price:"</span>, price))</span>
<span id="cb68-96"><a href="#cb68-96" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-97"><a href="#cb68-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb68-98"><a href="#cb68-98" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Selected color: Negro"
[1] "Processed: Negro - 250 - 252 - Price: 772.41"
[1] "Processed: Negro - 250 - 253 - Price: 900.08"
[1] "Processed: Negro - 226 - 252 - Price: 900.08"
[1] "Processed: Negro - 226 - 253 - Price: 930.09"
[1] "Processed: Negro - 227 - 252 - Price: 930.09"
[1] "Processed: Negro - 227 - 253 - Price: 930.09"
[1] "Selected color: Blanco"
[1] "Processed: Blanco - 250 - 252 - Price: 772.41"
[1] "Processed: Blanco - 226 - 252 - Price: 772.41"
[1] "Processed: Blanco - 227 - 252 - Price: 861.36"
[1] "Processed: Blanco - 227 - 253 - Price: 995.46"
[1] "Selected color: Rosa"
[1] "Processed: Rosa - 250 - 252 - Price: 995.46"
[1] "Processed: Rosa - 250 - 253 - Price: 995.46"
[1] "Processed: Rosa - 226 - 252 - Price: 995.46"
[1] "Processed: Rosa - 226 - 253 - Price: 808.34"
[1] "Processed: Rosa - 227 - 252 - Price: 808.34"
[1] "Selected color: Verde Azulado"
[1] "Processed: Verde Azulado - 250 - 252 - Price: 861.36"
[1] "Processed: Verde Azulado - 226 - 252 - Price: 861.36"
[1] "Processed: Verde Azulado - 226 - 253 - Price: 861.36"
[1] "Processed: Verde Azulado - 227 - 252 - Price: 772.41"
[1] "Processed: Verde Azulado - 227 - 253 - Price: 772.41"
[1] "Selected color: Azul Ultramar"
[1] "Processed: Azul Ultramar - 250 - 252 - Price: 772.41"
[1] "Processed: Azul Ultramar - 250 - 253 - Price: 861.36"
[1] "Processed: Azul Ultramar - 226 - 252 - Price: 861.36"
[1] "Processed: Azul Ultramar - 226 - 253 - Price: 861.36"
[1] "Processed: Azul Ultramar - 227 - 252 - Price: 861.36"
[1] "Processed: Azul Ultramar - 227 - 253 - Price: 861.36"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  refurbished_iphone <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No results found."</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>refurbished_iphone<span class="sc">$</span>state <span class="ot">&lt;-</span> <span class="fu">recode</span>(refurbished_iphone<span class="sc">$</span>state,</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"250"</span> <span class="ot">=</span> <span class="st">"Good"</span>,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"226"</span> <span class="ot">=</span> <span class="st">"Very Good"</span>,</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"227"</span> <span class="ot">=</span> <span class="st">"Excelent"</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>refurbished_iphone<span class="sc">$</span>storage <span class="ot">&lt;-</span> <span class="fu">recode</span>(refurbished_iphone<span class="sc">$</span>storage,</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"252"</span> <span class="ot">=</span> <span class="st">"128GB"</span>,</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"253"</span> <span class="ot">=</span> <span class="st">"256GB"</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="co"># iPad Pro</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>remDr <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"a.header-site-logo img"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>    input_box <span class="ot">&lt;-</span> x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//input[@id='inputSearch']"</span>)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>    input_box<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="st">"ipad pro"</span>))</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"xpath"</span>, <span class="at">value =</span> <span class="st">"//button[@class='form-search']//img"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>  })() <span class="sc">|&gt;</span> (\(x) { </span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)  </span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>    x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"a.btn-warning.primary-button.large-primary-button.mt-0.text-center"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>    x</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>  })()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$remoteServerAddr
[1] "localhost"

$port
[1] 4567

$browserName
[1] "firefox"

$version
[1] ""

$platform
[1] "ANY"

$javascript
[1] TRUE

$nativeEvents
[1] TRUE

$extraCapabilities
list()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>price_selector <span class="ot">&lt;-</span> <span class="st">"div.current-price span"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>product_name_selector <span class="ot">&lt;-</span> <span class="st">"h1.h1.page-title"</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>state_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_10 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>capacity_selector <span class="ot">&lt;-</span> <span class="st">"ul#group_14 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>connectivity_selector <span class="ot">&lt;-</span> <span class="st">"ul#group_17 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>extract_price <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr) {</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  price_element <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> price_selector)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  price_text <span class="ot">&lt;-</span> price_element<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>  clean_price <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^0-9,.]"</span>, <span class="st">""</span>, price_text)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, clean_price)))</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>get_options <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr, selector) {</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> selector)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  options <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (el <span class="cf">in</span> elements) {</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>      name <span class="ot">&lt;-</span> el<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"value"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>      options[[<span class="fu">length</span>(options) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> name, <span class="at">element =</span> el)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {})</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(options)</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>product_name <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> product_name_selector)<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="st">"Plata"</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>state_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, state_selectors)</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(state_info)) {</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>  state_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, state_selectors)</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(state_info) <span class="sc">&lt;</span> j) <span class="cf">next</span></span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>  state_info[[j]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>  current_state <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(state_info[[j]]<span class="sc">$</span>name <span class="sc">==</span> <span class="st">"226"</span>, <span class="st">"Very Good"</span>, <span class="st">"Excelent"</span>)</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>  capacity_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, capacity_selector)</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_along</span>(capacity_info)) {</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>    capacity_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, capacity_selector)</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(capacity_info) <span class="sc">&lt;</span> k) <span class="cf">next</span></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    capacity_info[[k]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    current_capacity <span class="ot">&lt;-</span> <span class="st">"128GB"</span></span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a>    connectivity_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, connectivity_selector)</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(connectivity_info) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>      connectivity_info[[<span class="dv">1</span>]]<span class="sc">$</span>element<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>      connectivity <span class="ot">&lt;-</span> <span class="st">"Wi-Fi"</span></span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a>      connectivity <span class="ot">&lt;-</span> <span class="st">"Unknown"</span></span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a>    price <span class="ot">&lt;-</span> <span class="fu">extract_price</span>(remDr)</span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a>    results[[<span class="fu">length</span>(results) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> product_name,</span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> color,</span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> current_state,</span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">storage =</span> current_capacity,</span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">connectivity =</span> connectivity,</span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">price =</span> price,</span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processed:"</span>, color, <span class="st">"-"</span>, current_state, <span class="st">"-"</span>, current_capacity, <span class="st">"-"</span>, connectivity, <span class="st">"- Price:"</span>, price))</span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processed: Plata - Very Good - 128GB - Wi-Fi - Price: 994.61"
[1] "Processed: Plata - Excelent - 128GB - Wi-Fi - Price: 994.61"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  refurbished_ipad <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"No results found."</span>)</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Macbook Air</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>remDr <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">5</span>)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"a.header-site-logo img"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>})() <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  input_box <span class="ot">&lt;-</span> x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"input#inputSearch.search-input.search-module"</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  input_box<span class="sc">$</span><span class="fu">sendKeysToElement</span>(<span class="fu">list</span>(<span class="st">"macbook air"</span>))</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a>})() <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"button.form-search img.submit-button"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>})() <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"ul.list-group.list-group-horizontal li.list-group-item div.search-result-box a.btn-warning"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>})() <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"li#list"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>})() <span class="sc">|&gt;</span> (\(x) {</span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>  x<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">"css selector"</span>, <span class="st">"div.product-container-img a.thumbnail.product-thumbnail"</span>)<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>  x</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>})()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$remoteServerAddr
[1] "localhost"

$port
[1] 4567

$browserName
[1] "firefox"

$version
[1] ""

$platform
[1] "ANY"

$javascript
[1] TRUE

$nativeEvents
[1] TRUE

$extraCapabilities
list()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>price_selector <span class="ot">&lt;-</span> <span class="st">"div.current-price span"</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>product_name_selector <span class="ot">&lt;-</span> <span class="st">"h1.h1.page-title"</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>color_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_39 li.input-container label input.input-color"</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>state_selectors <span class="ot">&lt;-</span> <span class="st">"ul#group_10 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>capacity_selector <span class="ot">&lt;-</span> <span class="st">"ul#group_14 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>processor_selector <span class="ot">&lt;-</span> <span class="st">"ul#group_22 li.input-container.float-xs-left label input.input-radio"</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>extract_price <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr) {</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  price_element <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> price_selector)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>  price_text <span class="ot">&lt;-</span> price_element<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>  clean_price <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"[^0-9,.]"</span>, <span class="st">""</span>, price_text)</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">","</span>, <span class="st">"."</span>, clean_price)))</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>get_options <span class="ot">&lt;-</span> <span class="cf">function</span>(remDr, selector) {</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>  elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> selector)</span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>  options <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (el <span class="cf">in</span> elements) {</span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tryCatch</span>({</span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>      name <span class="ot">&lt;-</span> el<span class="sc">$</span><span class="fu">getElementAttribute</span>(<span class="st">"value"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>      options[[<span class="fu">length</span>(options) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">name =</span> name)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">error =</span> <span class="cf">function</span>(e) {})</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(options)</span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>product_name <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElement</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> product_name_selector)<span class="sc">$</span><span class="fu">getElementText</span>()[[<span class="dv">1</span>]]</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>capacity <span class="ot">&lt;-</span> <span class="st">"256GB"</span></span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>processor <span class="ot">&lt;-</span> <span class="st">"Apple M1"</span></span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>color_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, color_selectors)</span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(color_info)) {</span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>  color_elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> color_selectors)</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(color_elements) <span class="sc">&lt;</span> i) <span class="cf">next</span></span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a>  color_elements[[i]]<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a>  color_map <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"space_gray"</span> <span class="ot">=</span> <span class="st">"Gris Sideral"</span>, <span class="st">"silver"</span> <span class="ot">=</span> <span class="st">"Plateado"</span>, <span class="st">"gold"</span> <span class="ot">=</span> <span class="st">"Dorado"</span>)</span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>  current_color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(color_info[[i]]<span class="sc">$</span>name <span class="sc">%in%</span> <span class="fu">names</span>(color_map), color_map[[color_info[[i]]<span class="sc">$</span>name]], color_info[[i]]<span class="sc">$</span>name)</span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a>  state_info <span class="ot">&lt;-</span> <span class="fu">get_options</span>(remDr, state_selectors)</span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(state_info)) {</span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">1</span>)</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>    state_elements <span class="ot">&lt;-</span> remDr<span class="sc">$</span><span class="fu">findElements</span>(<span class="at">using =</span> <span class="st">'css'</span>, <span class="at">value =</span> state_selectors)</span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(state_elements) <span class="sc">&lt;</span> j) <span class="cf">next</span></span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>    state_elements[[j]]<span class="sc">$</span><span class="fu">clickElement</span>()</span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a>    state_map <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"226"</span> <span class="ot">=</span> <span class="st">"Very Good"</span>, <span class="st">"227"</span> <span class="ot">=</span> <span class="st">"Good"</span>, <span class="st">"250"</span> <span class="ot">=</span> <span class="st">"Excelent"</span>)</span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a>    current_state <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(state_info[[j]]<span class="sc">$</span>name <span class="sc">%in%</span> <span class="fu">names</span>(state_map), state_map[[state_info[[j]]<span class="sc">$</span>name]], state_info[[j]]<span class="sc">$</span>name)</span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a>    price <span class="ot">&lt;-</span> <span class="fu">extract_price</span>(remDr)</span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a>    results[[<span class="fu">length</span>(results) <span class="sc">+</span> <span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> product_name,</span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> current_color,</span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">state =</span> current_state,</span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">storage =</span> capacity,</span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">processor =</span> processor,</span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">price =</span> price,</span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb76-74"><a href="#cb76-74" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb76-75"><a href="#cb76-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb76-76"><a href="#cb76-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Processed:"</span>, current_color, <span class="st">"-"</span>, current_state, <span class="st">"-"</span>, capacity, <span class="st">"-"</span>, processor, <span class="st">"- Price:"</span>, price))</span>
<span id="cb76-77"><a href="#cb76-77" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb76-78"><a href="#cb76-78" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Processed: 829 - Excelent - 256GB - Apple M1 - Price: 639.68"
[1] "Processed: 829 - Very Good - 256GB - Apple M1 - Price: 639.68"
[1] "Processed: 829 - Good - 256GB - Apple M1 - Price: 639.68"
[1] "Processed: 830 - Excelent - 256GB - Apple M1 - Price: 639.68"
[1] "Processed: 830 - Very Good - 256GB - Apple M1 - Price: 639.68"
[1] "Processed: 830 - Good - 256GB - Apple M1 - Price: 663.17"
[1] "Processed: 831 - Excelent - 256GB - Apple M1 - Price: 663.17"
[1] "Processed: 831 - Very Good - 256GB - Apple M1 - Price: 663.17"
[1] "Processed: 831 - Good - 256GB - Apple M1 - Price: 663.17"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">length</span>(results) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  refurbished_macbook <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, results)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">"Results not found."</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>refurbished_macbook<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">recode</span>(refurbished_macbook<span class="sc">$</span>color,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"829"</span> <span class="ot">=</span> <span class="st">"Sidereal Gray"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"830"</span> <span class="ot">=</span> <span class="st">"Silver"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"831"</span> <span class="ot">=</span> <span class="st">"Golden"</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">close</span>()</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>remDr<span class="sc">$</span><span class="fu">quit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>list()</code></pre>
</div>
</div>
<p>From all this code using RSelenium, we were able to automate the extraction of information about refurbished products. First, we accessed the home page and interacted with key interface elements, closing pop-up windows and using the search bar to locate specific products, such as the iPhone 16, iPad Pro and MacBook Air. From there, we navigate to product detail pages and capture data about their pricing, colors, states of preservation, storage capacities, and other relevant attributes.</p>
<p>For the iPhone 16, the code first locates and selects the model within the search results. It then identifies the different color, condition (refurbishment grade) and storage capacity options available. Through a series of nested loops, it runs through all possible combinations of these options, selecting each of them in the interface and extracting the final price of the product. This data is stored in a data structure for further analysis. In addition, the status and capability labels are normalized to make them more interpretable.</p>
<p>The same procedure is replicated for the iPad Pro and MacBook Air, with some differences in the website structure. In the case of the iPad Pro, the script also captures connectivity options (Wi-Fi or cellular version). In the case of the MacBook Air, in addition to color and status options, additional features such as processor and storage capacity are considered. Auxiliary functions are implemented to extract options from the selection menus and clean up the extracted values from the page.</p>
<p>At each iteration, the code prints on the console the progress of the scraping, indicating the processed combinations along with the corresponding price. Upon completion, the collected data is consolidated into structured dataframes for further analysis. Overall, the code is designed to systematically capture all available configurations of these products, allowing comparison of prices and features of refurbished devices.</p>
</section>
<section id="comparison" class="level1">
<h1>Comparison</h1>
<p>Once the two main scraping parts of this project are done, we proceed to combine the information to get the answer to our main idea: comparing new vs.&nbsp;refurbished Apple products.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>new_ipad<span class="sc">$</span>ram <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>new_iphone<span class="sc">$</span>ram <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the new products </span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>new_products <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(new_ipad, new_macbook, new_iphone)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>new_products <span class="ot">&lt;-</span> new_products <span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> <span class="st">"new"</span>,  <span class="co"># Add 'state' column</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">original_price =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(original_price, <span class="st">"[^0-9,]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">"."</span>)),</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">price =</span> <span class="fu">as.numeric</span>(<span class="fu">str_replace_all</span>(price, <span class="st">"[^0-9,]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">"."</span>)),</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">processor =</span> <span class="fu">case_when</span>(</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M2"</span>, id) <span class="sc">~</span> <span class="st">"Apple M2"</span>,  <span class="co"># If "M2" is detected, assign "Apple M2"</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"M4"</span>, id) <span class="sc">~</span> <span class="st">"Apple M4"</span>,  <span class="co"># If "M4" is detected, assign "Apple M4"</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>          <span class="co"># If neither is found, assign NA</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(new_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                         id                 name original_price
1 iPad Pro 13" Chip M4 256GB Negro espacial iPad Pro 13" Chip M4           1549
2          iPad Pro 13" Chip M4 256GB Plata iPad Pro 13" Chip M4           1549
3 iPad Pro 13" Chip M4 512GB Negro espacial iPad Pro 13" Chip M4           1799
4          iPad Pro 13" Chip M4 512GB Plata iPad Pro 13" Chip M4           1799
5   iPad Pro 13" Chip M4 1TB Negro espacial iPad Pro 13" Chip M4           2279
6            iPad Pro 13" Chip M4 1TB Plata iPad Pro 13" Chip M4           2279
  price storage          color
1  1469   256GB Negro espacial
2  1469   256GB          Plata
3  1699   512GB Negro espacial
4  1699   512GB          Plata
5  2159     1TB Negro espacial
6  2159     1TB          Plata
                                                                                                                                                        image
1 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
2         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
3 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
4         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
5 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
6         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
  connectivity  ram condition processor
1        Wi-Fi &lt;NA&gt;       new  Apple M4
2        Wi-Fi &lt;NA&gt;       new  Apple M4
3        Wi-Fi &lt;NA&gt;       new  Apple M4
4        Wi-Fi &lt;NA&gt;       new  Apple M4
5        Wi-Fi &lt;NA&gt;       new  Apple M4
6        Wi-Fi &lt;NA&gt;       new  Apple M4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(new_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"             "name"           "original_price" "price"         
 [5] "storage"        "color"          "image"          "connectivity"  
 [9] "ram"            "condition"      "processor"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>refurbished_products <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"https://github.com/pablormd/dataharvesting/raw/refs/heads/main/refurbished_products.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>refurbished_ipad<span class="sc">$</span>processor <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>refurbished_iphone<span class="sc">$</span>processor <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>refurbished_macbook<span class="sc">$</span>connectivity <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>refurbished_iphone<span class="sc">$</span>connectivity <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the refurbished products </span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>refurbished_products <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(refurbished_ipad, refurbished_macbook, refurbished_iphone)</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create new columns: 'id' (combining name, storage, and color) and 'condition' (set to 'refurbished')</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>refurbished_products <span class="ot">&lt;-</span> refurbished_products <span class="sc">%&gt;%</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">paste</span>(name, storage, color, <span class="at">sep =</span> <span class="st">" "</span>),  <span class="co"># Create a unique ID combining name, storage, and color</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">condition =</span> <span class="st">"refurbished"</span>  <span class="co"># Set the condition to 'refurbished' for all products</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(refurbished_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  name         color     state storage connectivity  price
1  iPad Pro 12.9" 2021         Plata Very Good   128GB        Wi-Fi 994.61
2  iPad Pro 12.9" 2021         Plata  Excelent   128GB        Wi-Fi 994.61
3 MacBook Air 13" 2020 Sidereal Gray  Excelent   256GB         &lt;NA&gt; 639.68
4 MacBook Air 13" 2020 Sidereal Gray Very Good   256GB         &lt;NA&gt; 639.68
5 MacBook Air 13" 2020 Sidereal Gray      Good   256GB         &lt;NA&gt; 639.68
6 MacBook Air 13" 2020        Silver  Excelent   256GB         &lt;NA&gt; 639.68
  processor                                       id   condition
1      &lt;NA&gt;          iPad Pro 12.9" 2021 128GB Plata refurbished
2      &lt;NA&gt;          iPad Pro 12.9" 2021 128GB Plata refurbished
3  Apple M1 MacBook Air 13" 2020 256GB Sidereal Gray refurbished
4  Apple M1 MacBook Air 13" 2020 256GB Sidereal Gray refurbished
5  Apple M1 MacBook Air 13" 2020 256GB Sidereal Gray refurbished
6  Apple M1        MacBook Air 13" 2020 256GB Silver refurbished</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(refurbished_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "name"         "color"        "state"        "storage"      "connectivity"
[6] "price"        "processor"    "id"           "condition"   </code></pre>
</div>
</div>
<p>In case Selenium cannot be used, you can load the dataset of refurbished products using the following code:</p>
<p>Now that we have both product tables, we can combine the information from both tables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine both datasets while keeping all the information</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>combined_products <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(new_products, refurbished_products)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the first records</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(combined_products)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                         id                 name original_price
1 iPad Pro 13" Chip M4 256GB Negro espacial iPad Pro 13" Chip M4           1549
2          iPad Pro 13" Chip M4 256GB Plata iPad Pro 13" Chip M4           1549
3 iPad Pro 13" Chip M4 512GB Negro espacial iPad Pro 13" Chip M4           1799
4          iPad Pro 13" Chip M4 512GB Plata iPad Pro 13" Chip M4           1799
5   iPad Pro 13" Chip M4 1TB Negro espacial iPad Pro 13" Chip M4           2279
6            iPad Pro 13" Chip M4 1TB Plata iPad Pro 13" Chip M4           2279
  price storage          color
1  1469   256GB Negro espacial
2  1469   256GB          Plata
3  1699   512GB Negro espacial
4  1699   512GB          Plata
5  2159     1TB Negro espacial
6  2159     1TB          Plata
                                                                                                                                                        image
1 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
2         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
3 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
4         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
5 https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-gris-espacial.jpg
6         https://static.k-tuin.com/media/catalog/product/cache/1/small_image/600x600/0dc2d03fe217f8c83829496872af24a0/i/p/ipad-pro-13-chip-m4-wifi-plata.jpg
  connectivity  ram condition processor state
1        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;
2        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;
3        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;
4        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;
5        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;
6        Wi-Fi &lt;NA&gt;       new  Apple M4  &lt;NA&gt;</code></pre>
</div>
</div>
<section id="visualization" class="level2">
<h2 class="anchored" data-anchor-id="visualization">Visualization:</h2>
<p>The next step is to display the results, and it has been decided to use the Shiny package to create an interactive application that allows users to view the products more efficiently and attractively.</p>
<p>Interactive elements such as dropdown menus to select features, search bars, and a layout that ensures clear and organized information visualization will be incorporated.</p>
<p>First choice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Product Comparator"</span>),</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"estado"</span>, <span class="st">"Select the product condition"</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="st">"new"</span>, <span class="st">"refurbished"</span>)),</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"producto"</span>, <span class="st">"Select a product:"</span>, <span class="at">choices =</span> <span class="cn">NULL</span>),</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"almacenamiento_ui"</span>),</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"ram_ui"</span>),</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"color_ui"</span>),</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"state_ui"</span>)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">"</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="st">        .precio {</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="st">          font-size: 30px;</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="st">          font-weight: bold;</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a><span class="st">          color: green;</span></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="st">        .precio-original {</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="st">          font-size: 20px;</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="st">          color: gray;</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="st">          text-decoration: line-through;</span></span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="st">        .error {</span></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="st">          color: red;</span></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="st">          font-weight: bold;</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)),</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"precio"</span>),</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"precio_original"</span>),</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"imagen_producto"</span>),</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">uiOutput</span>(<span class="st">"logo_tienda"</span>)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observe</span>({</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>estado)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>    productos_estado <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> input<span class="sc">$</span>estado)</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateSelectInput</span>(session, <span class="st">"producto"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(productos_estado<span class="sc">$</span>name))</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>almacenamiento_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto, input<span class="sc">$</span>estado)</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto, condition <span class="sc">==</span> input<span class="sc">$</span>estado)</span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>    available_storage <span class="ot">&lt;-</span> <span class="fu">unique</span>(prod<span class="sc">$</span>storage)</span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"Almacenamiento"</span>, <span class="st">"Select storage:"</span>, <span class="at">choices =</span> available_storage)</span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>ram_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto, input<span class="sc">$</span>estado, input<span class="sc">$</span>Almacenamiento)</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto, condition <span class="sc">==</span> input<span class="sc">$</span>estado, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento)</span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a>    ram_opciones <span class="ot">&lt;-</span> <span class="fu">unique</span>(prod<span class="sc">$</span>ram[<span class="sc">!</span><span class="fu">is.na</span>(prod<span class="sc">$</span>ram)])</span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(ram_opciones) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"ram"</span>, <span class="st">"Select RAM:"</span>, <span class="at">choices =</span> ram_opciones)</span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>color_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto, input<span class="sc">$</span>estado, input<span class="sc">$</span>Almacenamiento)</span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto, condition <span class="sc">==</span> input<span class="sc">$</span>estado, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento)</span>
<span id="cb91-72"><a href="#cb91-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-73"><a href="#cb91-73" aria-hidden="true" tabindex="-1"></a>    available_color <span class="ot">&lt;-</span> <span class="fu">unique</span>(prod<span class="sc">$</span>color)</span>
<span id="cb91-74"><a href="#cb91-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"color"</span>, <span class="st">"Select color:"</span>, <span class="at">choices =</span> available_color)</span>
<span id="cb91-75"><a href="#cb91-75" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-76"><a href="#cb91-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-77"><a href="#cb91-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-78"><a href="#cb91-78" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>state_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-79"><a href="#cb91-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>estado)</span>
<span id="cb91-80"><a href="#cb91-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>estado <span class="sc">==</span> <span class="st">"refurbished"</span>) {</span>
<span id="cb91-81"><a href="#cb91-81" aria-hidden="true" tabindex="-1"></a>      available_states <span class="ot">&lt;-</span> <span class="fu">unique</span>(combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"refurbished"</span>) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(state))</span>
<span id="cb91-82"><a href="#cb91-82" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"state"</span>, <span class="st">"Select product state"</span>, <span class="at">choices =</span> available_states)</span>
<span id="cb91-83"><a href="#cb91-83" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-84"><a href="#cb91-84" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-85"><a href="#cb91-85" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-86"><a href="#cb91-86" aria-hidden="true" tabindex="-1"></a>  producto_filtrado <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb91-87"><a href="#cb91-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>Almacenamiento, input<span class="sc">$</span>color)</span>
<span id="cb91-88"><a href="#cb91-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-89"><a href="#cb91-89" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span></span>
<span id="cb91-90"><a href="#cb91-90" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto, condition <span class="sc">==</span> input<span class="sc">$</span>estado, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento, color <span class="sc">==</span> input<span class="sc">$</span>color)</span>
<span id="cb91-91"><a href="#cb91-91" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-92"><a href="#cb91-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (input<span class="sc">$</span>estado <span class="sc">==</span> <span class="st">"refurbished"</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>state)) {</span>
<span id="cb91-93"><a href="#cb91-93" aria-hidden="true" tabindex="-1"></a>      prod <span class="ot">&lt;-</span> prod <span class="sc">%&gt;%</span> <span class="fu">filter</span>(state <span class="sc">==</span> input<span class="sc">$</span>state)</span>
<span id="cb91-94"><a href="#cb91-94" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-95"><a href="#cb91-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>ram) <span class="sc">&amp;&amp;</span> input<span class="sc">$</span>ram <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb91-96"><a href="#cb91-96" aria-hidden="true" tabindex="-1"></a>      prod <span class="ot">&lt;-</span> prod <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ram <span class="sc">==</span> input<span class="sc">$</span>ram)</span>
<span id="cb91-97"><a href="#cb91-97" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-98"><a href="#cb91-98" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-99"><a href="#cb91-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(prod)</span>
<span id="cb91-100"><a href="#cb91-100" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-101"><a href="#cb91-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-102"><a href="#cb91-102" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-103"><a href="#cb91-103" aria-hidden="true" tabindex="-1"></a>    prod_filtrado <span class="ot">&lt;-</span> <span class="fu">producto_filtrado</span>()</span>
<span id="cb91-104"><a href="#cb91-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod_filtrado) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb91-105"><a href="#cb91-105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌  NO Products were found with this filter.&lt;/span&gt;"</span>))</span>
<span id="cb91-106"><a href="#cb91-106" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-107"><a href="#cb91-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">HTML</span>(<span class="fu">paste0</span>(<span class="st">"&lt;span class='precio'&gt;💰 Price: "</span>, prod_filtrado<span class="sc">$</span>price, <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb91-108"><a href="#cb91-108" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-109"><a href="#cb91-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-110"><a href="#cb91-110" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio_original <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-111"><a href="#cb91-111" aria-hidden="true" tabindex="-1"></a>    prod_filtrado <span class="ot">&lt;-</span> <span class="fu">producto_filtrado</span>()</span>
<span id="cb91-112"><a href="#cb91-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod_filtrado) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb91-113"><a href="#cb91-113" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌  NO products were found with thhis filter.&lt;/span&gt;"</span>))</span>
<span id="cb91-114"><a href="#cb91-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-115"><a href="#cb91-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(prod_filtrado<span class="sc">$</span>original_price[<span class="dv">1</span>])) {</span>
<span id="cb91-116"><a href="#cb91-116" aria-hidden="true" tabindex="-1"></a>      <span class="fu">HTML</span>(<span class="fu">paste</span>(<span class="st">"&lt;span class='precio-original'&gt;🔥 Original Price: "</span>, prod_filtrado<span class="sc">$</span>original_price, <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb91-117"><a href="#cb91-117" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb91-118"><a href="#cb91-118" aria-hidden="true" tabindex="-1"></a>      <span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ there is no original price&lt;/span&gt;"</span>)</span>
<span id="cb91-119"><a href="#cb91-119" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-120"><a href="#cb91-120" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-121"><a href="#cb91-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-122"><a href="#cb91-122" aria-hidden="true" tabindex="-1"></a>output<span class="sc">$</span>imagen_producto <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-123"><a href="#cb91-123" aria-hidden="true" tabindex="-1"></a>  prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado</span>()</span>
<span id="cb91-124"><a href="#cb91-124" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-125"><a href="#cb91-125" aria-hidden="true" tabindex="-1"></a>  img_url <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(input<span class="sc">$</span>producto <span class="sc">==</span> <span class="st">"iPhone 16"</span>, </span>
<span id="cb91-126"><a href="#cb91-126" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTnnfVQ1-eOfp0VJEAbb1SqaO9ah2J6OIoJsQ&amp;s"</span>,</span>
<span id="cb91-127"><a href="#cb91-127" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(input<span class="sc">$</span>producto <span class="sc">==</span> <span class="st">'iPad Pro 12.9" 2021'</span>, </span>
<span id="cb91-128"><a href="#cb91-128" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"https://m.media-amazon.com/images/I/81+N4PFF7jS._AC_UF1000,1000_QL80_.jpg"</span>,</span>
<span id="cb91-129"><a href="#cb91-129" aria-hidden="true" tabindex="-1"></a>             <span class="fu">ifelse</span>(input<span class="sc">$</span>producto <span class="sc">==</span> <span class="st">'MacBook Air 13 " 2020'</span>, </span>
<span id="cb91-130"><a href="#cb91-130" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"https://m.media-amazon.com/images/I/71yIXm6ED2L._AC_UF1000,1000_QL80_.jpg"</span>,</span>
<span id="cb91-131"><a href="#cb91-131" aria-hidden="true" tabindex="-1"></a>                    prod<span class="sc">$</span>image)))  </span>
<span id="cb91-132"><a href="#cb91-132" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(img_url) <span class="sc">&amp;&amp;</span> <span class="fu">nchar</span>(img_url) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb91-133"><a href="#cb91-133" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> img_url, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Product image"</span>)</span>
<span id="cb91-134"><a href="#cb91-134" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb91-135"><a href="#cb91-135" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"default-image.jpg"</span>, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Image not available"</span>)</span>
<span id="cb91-136"><a href="#cb91-136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb91-137"><a href="#cb91-137" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb91-138"><a href="#cb91-138" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-139"><a href="#cb91-139" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>logo_tienda <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb91-140"><a href="#cb91-140" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado</span>()</span>
<span id="cb91-141"><a href="#cb91-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-142"><a href="#cb91-142" aria-hidden="true" tabindex="-1"></a>    logo_url_new <span class="ot">&lt;-</span> <span class="st">"https://www.plazalogistica.com/wp-content/uploads/sites/5/2019/03/logoKtuin.jpg"</span> </span>
<span id="cb91-143"><a href="#cb91-143" aria-hidden="true" tabindex="-1"></a>    logo_url_refurbished <span class="ot">&lt;-</span> <span class="st">"https://s3-eu-west-1.amazonaws.com/tpd/logos/5c5327a345f25d0001519cca/0x0.png"</span> </span>
<span id="cb91-144"><a href="#cb91-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb91-145"><a href="#cb91-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb91-146"><a href="#cb91-146" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (prod<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">"new"</span>) {</span>
<span id="cb91-147"><a href="#cb91-147" aria-hidden="true" tabindex="-1"></a>        tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> logo_url_new, <span class="at">height =</span> <span class="st">"150px"</span>, <span class="at">alt =</span> <span class="st">"Store Logo - New"</span>)</span>
<span id="cb91-148"><a href="#cb91-148" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (prod<span class="sc">$</span>condition <span class="sc">==</span> <span class="st">"refurbished"</span>) {</span>
<span id="cb91-149"><a href="#cb91-149" aria-hidden="true" tabindex="-1"></a>        tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> logo_url_refurbished, <span class="at">height =</span> <span class="st">"150px"</span>, <span class="at">alt =</span> <span class="st">"Store Logo - Refurbished"</span>)</span>
<span id="cb91-150"><a href="#cb91-150" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb91-151"><a href="#cb91-151" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb91-152"><a href="#cb91-152" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-153"><a href="#cb91-153" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-154"><a href="#cb91-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-155"><a href="#cb91-155" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
<p>Second choice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>ui <span class="ot">&lt;-</span> <span class="fu">fluidPage</span>(</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">titlePanel</span>(<span class="st">"Product Comparator"</span>),</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sidebarLayout</span>(</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sidebarPanel</span>(</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fluidRow</span>(</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>          <span class="fu">wellPanel</span>(</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">h4</span>(<span class="st">"New Product"</span>),</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">selectInput</span>(<span class="st">"producto_new"</span>, <span class="st">"Select a product (New):"</span>, <span class="at">choices =</span> <span class="cn">NULL</span>),</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"almacenamiento_new_ui"</span>),</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"ram_new_ui"</span>),</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"color_new_ui"</span>)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fluidRow</span>(</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">12</span>,</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>          <span class="fu">wellPanel</span>(</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">h4</span>(<span class="st">"Refurbished Products"</span>),</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>            <span class="fu">selectInput</span>(<span class="st">"producto_refurbished"</span>, <span class="st">"Select a product (Refurbished):"</span>, <span class="at">choices =</span> <span class="cn">NULL</span>),</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"almacenamiento_refurbished_ui"</span>),</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"ram_refurbished_ui"</span>),</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"color_refurbished_ui"</span>),</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">uiOutput</span>(<span class="st">"state_refurbished_ui"</span>) </span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mainPanel</span>(</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">style</span>(<span class="fu">HTML</span>(<span class="st">"</span></span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a><span class="st">        .precio {</span></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a><span class="st">          font-size: 30px;</span></span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a><span class="st">          font-weight: bold;</span></span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a><span class="st">        .precio-original {</span></span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a><span class="st">          font-size: 24px;</span></span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a><span class="st">          color: red;</span></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a><span class="st">          font-weight: bold;</span></span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a><span class="st">        .error {</span></span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a><span class="st">          color: red;</span></span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a><span class="st">        }</span></span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span>)),</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fluidRow</span>(</span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">6</span>, </span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"precio_new"</span>),</span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"precio_original_new"</span>),</span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"imagen_producto_new"</span>),</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"logo_tienda_new"</span>)),</span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a>        <span class="fu">column</span>(<span class="dv">6</span>, </span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"precio_refurbished"</span>),</span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"precio_original_refurbished"</span>),</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"imagen_producto_refurbished"</span>),</span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>               <span class="fu">uiOutput</span>(<span class="st">"logo_tienda_refurbished"</span>))</span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-65"><a href="#cb92-65" aria-hidden="true" tabindex="-1"></a>server <span class="ot">&lt;-</span> <span class="cf">function</span>(input, output, session) {</span>
<span id="cb92-66"><a href="#cb92-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-67"><a href="#cb92-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observe</span>({</span>
<span id="cb92-68"><a href="#cb92-68" aria-hidden="true" tabindex="-1"></a>    productos_estado_new <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"new"</span>)</span>
<span id="cb92-69"><a href="#cb92-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateSelectInput</span>(session, <span class="st">"producto_new"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(productos_estado_new<span class="sc">$</span>name))</span>
<span id="cb92-70"><a href="#cb92-70" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-71"><a href="#cb92-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-72"><a href="#cb92-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observe</span>({</span>
<span id="cb92-73"><a href="#cb92-73" aria-hidden="true" tabindex="-1"></a>    productos_estado_refurbished <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"refurbished"</span>)</span>
<span id="cb92-74"><a href="#cb92-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateSelectInput</span>(session, <span class="st">"producto_refurbished"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(productos_estado_refurbished<span class="sc">$</span>name))</span>
<span id="cb92-75"><a href="#cb92-75" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-76"><a href="#cb92-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-77"><a href="#cb92-77" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb92-78"><a href="#cb92-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">observeEvent</span>(input<span class="sc">$</span>producto_new, {</span>
<span id="cb92-79"><a href="#cb92-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_new)</span>
<span id="cb92-80"><a href="#cb92-80" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb92-81"><a href="#cb92-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-82"><a href="#cb92-82" aria-hidden="true" tabindex="-1"></a>    categoria <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"iPhone"</span>, input<span class="sc">$</span>producto_new, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>), <span class="st">"iPhone"</span>,</span>
<span id="cb92-83"><a href="#cb92-83" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"iPad"</span>, input<span class="sc">$</span>producto_new, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>), <span class="st">"iPad"</span>,</span>
<span id="cb92-84"><a href="#cb92-84" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">"MacBook"</span>, input<span class="sc">$</span>producto_new, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>), <span class="st">"MacBook"</span>, <span class="cn">NA</span>)))</span>
<span id="cb92-85"><a href="#cb92-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-86"><a href="#cb92-86" aria-hidden="true" tabindex="-1"></a>    productos_refurbished_filtrados <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span></span>
<span id="cb92-87"><a href="#cb92-87" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(condition <span class="sc">==</span> <span class="st">"refurbished"</span> <span class="sc">&amp;</span> <span class="fu">grepl</span>(categoria, name, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb92-88"><a href="#cb92-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-89"><a href="#cb92-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">updateSelectInput</span>(session, <span class="st">"producto_refurbished"</span>, </span>
<span id="cb92-90"><a href="#cb92-90" aria-hidden="true" tabindex="-1"></a>                      <span class="at">choices =</span> <span class="fu">unique</span>(productos_refurbished_filtrados<span class="sc">$</span>name))</span>
<span id="cb92-91"><a href="#cb92-91" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-92"><a href="#cb92-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-93"><a href="#cb92-93" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>almacenamiento_new_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-94"><a href="#cb92-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_new)</span>
<span id="cb92-95"><a href="#cb92-95" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_new, condition <span class="sc">==</span> <span class="st">"new"</span>)</span>
<span id="cb92-96"><a href="#cb92-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"Almacenamiento_new"</span>, <span class="st">"Select storage:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(prod<span class="sc">$</span>storage))</span>
<span id="cb92-97"><a href="#cb92-97" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-98"><a href="#cb92-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-99"><a href="#cb92-99" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>almacenamiento_refurbished_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-100"><a href="#cb92-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_refurbished)</span>
<span id="cb92-101"><a href="#cb92-101" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_refurbished, condition <span class="sc">==</span> <span class="st">"refurbished"</span>)</span>
<span id="cb92-102"><a href="#cb92-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"Almacenamiento_refurbished"</span>, <span class="st">"Select storage:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(prod<span class="sc">$</span>storage))</span>
<span id="cb92-103"><a href="#cb92-103" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-104"><a href="#cb92-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-105"><a href="#cb92-105" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>ram_new_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-106"><a href="#cb92-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_new, input<span class="sc">$</span>Almacenamiento_new)</span>
<span id="cb92-107"><a href="#cb92-107" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_new, condition <span class="sc">==</span> <span class="st">"new"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_new)</span>
<span id="cb92-108"><a href="#cb92-108" aria-hidden="true" tabindex="-1"></a>    ram_opciones <span class="ot">&lt;-</span> <span class="fu">unique</span>(prod<span class="sc">$</span>ram[<span class="sc">!</span><span class="fu">is.na</span>(prod<span class="sc">$</span>ram)])</span>
<span id="cb92-109"><a href="#cb92-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(ram_opciones) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb92-110"><a href="#cb92-110" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"ram_new"</span>, <span class="st">"Select RAM:"</span>, <span class="at">choices =</span> ram_opciones)</span>
<span id="cb92-111"><a href="#cb92-111" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-112"><a href="#cb92-112" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-113"><a href="#cb92-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-114"><a href="#cb92-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-115"><a href="#cb92-115" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>ram_refurbished_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-116"><a href="#cb92-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_refurbished, input<span class="sc">$</span>Almacenamiento_refurbished)</span>
<span id="cb92-117"><a href="#cb92-117" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_refurbished, condition <span class="sc">==</span> <span class="st">"refurbished"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_refurbished)</span>
<span id="cb92-118"><a href="#cb92-118" aria-hidden="true" tabindex="-1"></a>    ram_opciones <span class="ot">&lt;-</span> <span class="fu">unique</span>(prod<span class="sc">$</span>ram[<span class="sc">!</span><span class="fu">is.na</span>(prod<span class="sc">$</span>ram)])</span>
<span id="cb92-119"><a href="#cb92-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">length</span>(ram_opciones) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb92-120"><a href="#cb92-120" aria-hidden="true" tabindex="-1"></a>      <span class="fu">selectInput</span>(<span class="st">"ram_refurbished"</span>, <span class="st">"Select RAM:"</span>, <span class="at">choices =</span> ram_opciones)</span>
<span id="cb92-121"><a href="#cb92-121" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-122"><a href="#cb92-122" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-123"><a href="#cb92-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-124"><a href="#cb92-124" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>color_new_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-125"><a href="#cb92-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_new, input<span class="sc">$</span>Almacenamiento_new)</span>
<span id="cb92-126"><a href="#cb92-126" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_new, condition <span class="sc">==</span> <span class="st">"new"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_new)</span>
<span id="cb92-127"><a href="#cb92-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"color_new"</span>, <span class="st">"Select color:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(prod<span class="sc">$</span>color))</span>
<span id="cb92-128"><a href="#cb92-128" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-129"><a href="#cb92-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-130"><a href="#cb92-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-131"><a href="#cb92-131" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>color_refurbished_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-132"><a href="#cb92-132" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_refurbished, input<span class="sc">$</span>Almacenamiento_refurbished)</span>
<span id="cb92-133"><a href="#cb92-133" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_refurbished, condition <span class="sc">==</span> <span class="st">"refurbished"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_refurbished)</span>
<span id="cb92-134"><a href="#cb92-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"color_refurbished"</span>, <span class="st">"Select color:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(prod<span class="sc">$</span>color))</span>
<span id="cb92-135"><a href="#cb92-135" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-136"><a href="#cb92-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-137"><a href="#cb92-137" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>state_refurbished_ui <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-138"><a href="#cb92-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>producto_refurbished)</span>
<span id="cb92-139"><a href="#cb92-139" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_refurbished, condition <span class="sc">==</span> <span class="st">"refurbished"</span>)</span>
<span id="cb92-140"><a href="#cb92-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">selectInput</span>(<span class="st">"state_refurbished"</span>, <span class="st">"Select state:"</span>, <span class="at">choices =</span> <span class="fu">unique</span>(prod<span class="sc">$</span>state))</span>
<span id="cb92-141"><a href="#cb92-141" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-142"><a href="#cb92-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-143"><a href="#cb92-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-144"><a href="#cb92-144" aria-hidden="true" tabindex="-1"></a>  producto_filtrado_new <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb92-145"><a href="#cb92-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>Almacenamiento_new, input<span class="sc">$</span>color_new)</span>
<span id="cb92-146"><a href="#cb92-146" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> </span>
<span id="cb92-147"><a href="#cb92-147" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_new, condition <span class="sc">==</span> <span class="st">"new"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_new, color <span class="sc">==</span> input<span class="sc">$</span>color_new)</span>
<span id="cb92-148"><a href="#cb92-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>ram_new) <span class="sc">&amp;&amp;</span> input<span class="sc">$</span>ram_new <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb92-149"><a href="#cb92-149" aria-hidden="true" tabindex="-1"></a>      prod <span class="ot">&lt;-</span> prod <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ram <span class="sc">==</span> input<span class="sc">$</span>ram_new)</span>
<span id="cb92-150"><a href="#cb92-150" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-151"><a href="#cb92-151" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(prod)</span>
<span id="cb92-152"><a href="#cb92-152" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-153"><a href="#cb92-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-154"><a href="#cb92-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-155"><a href="#cb92-155" aria-hidden="true" tabindex="-1"></a>  producto_filtrado_refurbished <span class="ot">&lt;-</span> <span class="fu">reactive</span>({</span>
<span id="cb92-156"><a href="#cb92-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">req</span>(input<span class="sc">$</span>Almacenamiento_refurbished, input<span class="sc">$</span>color_refurbished, input<span class="sc">$</span>state_refurbished)</span>
<span id="cb92-157"><a href="#cb92-157" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> combined_products <span class="sc">%&gt;%</span> </span>
<span id="cb92-158"><a href="#cb92-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(name <span class="sc">==</span> input<span class="sc">$</span>producto_refurbished, condition <span class="sc">==</span> <span class="st">"refurbished"</span>, storage <span class="sc">==</span> input<span class="sc">$</span>Almacenamiento_refurbished, color <span class="sc">==</span> input<span class="sc">$</span>color_refurbished, state <span class="sc">==</span> input<span class="sc">$</span>state_refurbished)</span>
<span id="cb92-159"><a href="#cb92-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(input<span class="sc">$</span>ram_refurbished) <span class="sc">&amp;&amp;</span> input<span class="sc">$</span>ram_refurbished <span class="sc">!=</span> <span class="st">""</span>) {</span>
<span id="cb92-160"><a href="#cb92-160" aria-hidden="true" tabindex="-1"></a>      prod <span class="ot">&lt;-</span> prod <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ram <span class="sc">==</span> input<span class="sc">$</span>ram_refurbished)</span>
<span id="cb92-161"><a href="#cb92-161" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-162"><a href="#cb92-162" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(prod)</span>
<span id="cb92-163"><a href="#cb92-163" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-164"><a href="#cb92-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-165"><a href="#cb92-165" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio_new <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-166"><a href="#cb92-166" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_new</span>()</span>
<span id="cb92-167"><a href="#cb92-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No products found.&lt;/span&gt;"</span>))</span>
<span id="cb92-168"><a href="#cb92-168" aria-hidden="true" tabindex="-1"></a>    <span class="fu">HTML</span>(<span class="fu">paste0</span>(<span class="st">"&lt;span class='precio'&gt;💰 Price: "</span>, <span class="fu">formatC</span>(prod<span class="sc">$</span>price[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb92-169"><a href="#cb92-169" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-170"><a href="#cb92-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-171"><a href="#cb92-171" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio_original_new <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-172"><a href="#cb92-172" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_new</span>()</span>
<span id="cb92-173"><a href="#cb92-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No products found.&lt;/span&gt;"</span>))</span>
<span id="cb92-174"><a href="#cb92-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(prod<span class="sc">$</span>original_price[<span class="dv">1</span>])) {</span>
<span id="cb92-175"><a href="#cb92-175" aria-hidden="true" tabindex="-1"></a>      <span class="fu">HTML</span>(<span class="fu">paste</span>(<span class="st">"&lt;span class='precio-original'&gt;🔥 Original Price: "</span>, <span class="fu">formatC</span>(prod<span class="sc">$</span>original_price[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb92-176"><a href="#cb92-176" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb92-177"><a href="#cb92-177" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No original price available.&lt;/span&gt;"</span>))</span>
<span id="cb92-178"><a href="#cb92-178" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-179"><a href="#cb92-179" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-180"><a href="#cb92-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-181"><a href="#cb92-181" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio_refurbished <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-182"><a href="#cb92-182" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_refurbished</span>()</span>
<span id="cb92-183"><a href="#cb92-183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No products found.&lt;/span&gt;"</span>))</span>
<span id="cb92-184"><a href="#cb92-184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">HTML</span>(<span class="fu">paste0</span>(<span class="st">"&lt;span class='precio'&gt;💰 Price: "</span>, <span class="fu">formatC</span>(prod<span class="sc">$</span>price[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb92-185"><a href="#cb92-185" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-186"><a href="#cb92-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-187"><a href="#cb92-187" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>precio_original_refurbished <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-188"><a href="#cb92-188" aria-hidden="true" tabindex="-1"></a>    prod <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_refurbished</span>()</span>
<span id="cb92-189"><a href="#cb92-189" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No products found.&lt;/span&gt;"</span>))</span>
<span id="cb92-190"><a href="#cb92-190" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.na</span>(prod<span class="sc">$</span>original_price[<span class="dv">1</span>])) {</span>
<span id="cb92-191"><a href="#cb92-191" aria-hidden="true" tabindex="-1"></a>      <span class="fu">HTML</span>(<span class="fu">paste</span>(<span class="st">"&lt;span class='precio-original'&gt;🔥 Original Price: "</span>, <span class="fu">formatC</span>(prod<span class="sc">$</span>original_price[<span class="dv">1</span>], <span class="at">format =</span> <span class="st">"f"</span>, <span class="at">digits =</span> <span class="dv">2</span>), <span class="st">"€&lt;/span&gt;"</span>))</span>
<span id="cb92-192"><a href="#cb92-192" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb92-193"><a href="#cb92-193" aria-hidden="true" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">HTML</span>(<span class="st">"&lt;span class='error'&gt;❌ No original price available.&lt;/span&gt;"</span>))</span>
<span id="cb92-194"><a href="#cb92-194" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-195"><a href="#cb92-195" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-196"><a href="#cb92-196" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>imagen_producto_new <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-197"><a href="#cb92-197" aria-hidden="true" tabindex="-1"></a>    prod_new <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_new</span>()</span>
<span id="cb92-198"><a href="#cb92-198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod_new) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb92-199"><a href="#cb92-199" aria-hidden="true" tabindex="-1"></a>      img_url <span class="ot">&lt;-</span> prod_new<span class="sc">$</span>image[<span class="dv">1</span>]</span>
<span id="cb92-200"><a href="#cb92-200" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> img_url, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Product image"</span>)</span>
<span id="cb92-201"><a href="#cb92-201" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb92-202"><a href="#cb92-202" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"default-image.jpg"</span>, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Image not available"</span>)</span>
<span id="cb92-203"><a href="#cb92-203" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-204"><a href="#cb92-204" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-205"><a href="#cb92-205" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-206"><a href="#cb92-206" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>imagen_producto_refurbished <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-207"><a href="#cb92-207" aria-hidden="true" tabindex="-1"></a>    prod_refurbished <span class="ot">&lt;-</span> <span class="fu">producto_filtrado_refurbished</span>()</span>
<span id="cb92-208"><a href="#cb92-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">nrow</span>(prod_refurbished) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb92-209"><a href="#cb92-209" aria-hidden="true" tabindex="-1"></a>      img_url <span class="ot">&lt;-</span> <span class="cf">switch</span>(prod_refurbished<span class="sc">$</span>name[<span class="dv">1</span>], </span>
<span id="cb92-210"><a href="#cb92-210" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"iPhone 16"</span> <span class="ot">=</span> <span class="st">"https://cdn.grupoelcorteingles.es/SGFM/dctm/MEDIA03/202409/10/00194612201288____11__1200x1200.jpg"</span>, </span>
<span id="cb92-211"><a href="#cb92-211" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"MacBook Air 13</span><span class="sc">\"</span><span class="st"> 2020"</span> <span class="ot">=</span> <span class="st">"https://m.media-amazon.com/images/I/71yIXm6ED2L._AC_UF1000,1000_QL80_.jpg"</span>, </span>
<span id="cb92-212"><a href="#cb92-212" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"iPad Pro 12.9</span><span class="sc">\"</span><span class="st"> 2021"</span> <span class="ot">=</span> <span class="st">"https://m.media-amazon.com/images/I/815KnP2wjDS.jpg"</span>, </span>
<span id="cb92-213"><a href="#cb92-213" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"default-image.jpg"</span>)</span>
<span id="cb92-214"><a href="#cb92-214" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> img_url, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Refurbished product image"</span>)</span>
<span id="cb92-215"><a href="#cb92-215" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb92-216"><a href="#cb92-216" aria-hidden="true" tabindex="-1"></a>      tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"default-image.jpg"</span>, <span class="at">height =</span> <span class="st">"300px"</span>, <span class="at">alt =</span> <span class="st">"Image not available"</span>)</span>
<span id="cb92-217"><a href="#cb92-217" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb92-218"><a href="#cb92-218" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-219"><a href="#cb92-219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb92-220"><a href="#cb92-220" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>logo_tienda_new <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-221"><a href="#cb92-221" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"https://www.plazalogistica.com/wp-content/uploads/sites/5/2019/03/logoKtuin.jpg"</span>, <span class="at">height =</span> <span class="st">"150px"</span>, <span class="at">alt =</span> <span class="st">"Store Logo - New"</span>)</span>
<span id="cb92-222"><a href="#cb92-222" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-223"><a href="#cb92-223" aria-hidden="true" tabindex="-1"></a>  output<span class="sc">$</span>logo_tienda_refurbished <span class="ot">&lt;-</span> <span class="fu">renderUI</span>({</span>
<span id="cb92-224"><a href="#cb92-224" aria-hidden="true" tabindex="-1"></a>    tags<span class="sc">$</span><span class="fu">img</span>(<span class="at">src =</span> <span class="st">"https://s3-eu-west-1.amazonaws.com/tpd/logos/5c5327a345f25d0001519cca/0x0.png"</span>, <span class="at">height =</span> <span class="st">"150px"</span>, <span class="at">alt =</span> <span class="st">"Store Logo - Refurbished"</span>)</span>
<span id="cb92-225"><a href="#cb92-225" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb92-226"><a href="#cb92-226" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-227"><a href="#cb92-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-228"><a href="#cb92-228" aria-hidden="true" tabindex="-1"></a><span class="fu">shinyApp</span>(<span class="at">ui =</span> ui, <span class="at">server =</span> server)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p></p><div style="width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;" class="muted well">Shiny applications not supported in static R Markdown documents</div><p></p>
</div>
</div>
</section>
</section>
<section id="final-considerations" class="level1">
<h1>Final Considerations</h1>
<p>In this paper, we have carried out a data extraction process using web scraping techniques to analyze and compare the prices of new and refurbished Apple products. To do so, we combined two different approaches: manual scraping in R for new products and automation with RSelenium for refurbished products. This methodological choice allowed us to apply in a practical way the different scraping methods covered in the course, ensuring a comprehensive understanding of their advantages and limitations.</p>
<p>After obtaining the data, a cleaning and standardization process was carried out to ensure the consistency and quality of the resulting dataset. Subsequently, an application was developed in Shiny that allows users to compare products based on several variables, facilitating informed decision making. The application not only provides a clear and accessible visualization of the information, but also demonstrates the usefulness of scraping in gathering relevant data for market analysis and price comparison.</p>
<section id="proposals-for-improvement" class="level2">
<h2 class="anchored" data-anchor-id="proposals-for-improvement">Proposals for improvement</h2>
<p>Despite the results obtained, there are several aspects that could be optimized in future work: 1. Expansion of the data source: Currently, the data come from a single source. Including information from other distributors or secondary markets would provide a broader and more representative view of price differences. 2. Automating manual scraping: While manual scraping in R has been useful for understanding the technique, implementing a more automated solution would reduce run times and increase the scalability of the analysis. 3. Enrichment of the dataset: Incorporating additional variables, such as user opinions, warranties or availability in different regions, could improve the depth of the analysis. 4. Optimization of the Shiny App: More advanced filters, additional interactive graphics and better response times could be implemented to make it more efficient and usable. 5. Predictive analytics: Apply Machine Learning techniques to predict the price evolution of refurbished products based on their demand and availability in the market.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>This study has demonstrated the applicability of web scraping for data collection and analysis in commercial environments. The combination of manual and automated scraping has given us a practical perspective on its advantages and challenges, highlighting the importance of choosing the most appropriate technique according to the context.</p>
<p>The integration of the data into an interactive application has added value to the analysis, facilitating the comparison of products and allowing us to explore price differences in an efficient way. Moreover, the experience gained throughout this work reinforces the relevance of web scraping as a key tool in obtaining strategic information in various fields, from market analysis to computational social science research.</p>
<p>Future developments could focus on optimizing and automating the process, as well as enriching the data through additional sources and advanced analysis. In short, this work represents a solid starting point for data exploration and exploitation using web scraping techniques, with practical applications in multiple disciplines.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>